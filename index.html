<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <!-- Viewport optimizado para todos los m√≥viles -->
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, viewport-fit=cover">
    <title>BajaStay Rentals - AR Virtual Traveling</title>
    <meta name="description"
        content="Navegaci√≥n GPS estilo Google Maps desde el aeropuerto hasta BajaStay Rentals en La Paz y Los Cabos, Baja California Sur.">

    <!-- PWA / Add to Home Screen -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#c8e6c9">

    <!-- iOS Safari / iPhone -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="BajaStay Nav">
    <link rel="apple-touch-icon" href="logo.jpeg">

    <!-- Android Chrome -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="BajaStay Nav">

    <!-- Fuente con display=swap para carga no bloqueante -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">

    <!-- Mapbox GL JS -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
    <!-- A-Frame y AR.js eliminados: ya no se usa c√°mara AR -->

    <style>
        /* ============================================================
           VARIABLES Y RESET - Compatible Chrome / Safari / Firefox
        ============================================================ */
        :root {
            --primary: #e8f5e9;
            --accent: #29b6f6;
            --glass: rgba(232, 245, 233, 0.92);
            --glass-border: rgba(41, 182, 246, 0.3);
            --text: #1a3a2a;
            --font: 'Outfit', sans-serif;
            /* Safe area para iPhone X+ / notch */
            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bottom: env(safe-area-inset-bottom, 0px);
            --safe-left: env(safe-area-inset-left, 0px);
            --safe-right: env(safe-area-inset-right, 0px);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        html,
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            /* Evitar el rebote el√°stico de iOS */
            overscroll-behavior: none;
        }

        body {
            background: linear-gradient(160deg, #c8e6c9 0%, #e0f2f1 50%, #b2dfdb 100%);
            font-family: var(--font), -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            color: var(--text);
            /* Rendering de fuentes m√°s suave en Safari */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            /* Prevenir selecci√≥n accidental en t√°ctil */
            -webkit-user-select: none;
            user-select: none;
            /* Altura fija para iOS (100vh falla en Safari m√≥vil con barra de direcciones) */
            height: 100dvh;
        }

        #loader {
            position: fixed;
            inset: 0;
            z-index: 3000;
            background: linear-gradient(160deg, #c8e6c9 0%, #e0f2f1 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(41, 182, 246, 0.25);
            border-top-color: var(--accent);
            border-radius: 50%;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @-webkit-keyframes spin {
            to {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        #landing-overlay {
            position: fixed;
            inset: 0;
            z-index: 2000;
            background: linear-gradient(160deg, #c8e6c9 0%, #e0f2f1 50%, #b2dfdb 100%);
            display: flex;
            flex-direction: column;
            /* Padding extra para el notch y barra de inicio de iOS */
            padding: calc(20px + var(--safe-top)) 30px calc(20px + var(--safe-bottom));
            -webkit-transition: -webkit-transform 0.6s cubic-bezier(0.22, 1, 0.36, 1);
            transition: transform 0.6s cubic-bezier(0.22, 1, 0.36, 1);
        }

        #landing-overlay.closed {
            -webkit-transform: translateY(-100%);
            transform: translateY(-100%);
        }

        .landing-header {
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .big-logo {
            width: 72px;
            height: 72px;
            background: white;
            border-radius: 20px;
            background-image: url('logo.jpeg');
            background-size: contain !important;
            background-position: center;
            background-repeat: no-repeat;
            -webkit-box-shadow: 0 8px 25px rgba(41, 182, 246, 0.15);
            box-shadow: 0 8px 25px rgba(41, 182, 246, 0.15);
            flex-shrink: 0;
        }

        .landing-title h1 {
            margin: 0;
            font-size: clamp(24px, 7vw, 32px);
            font-weight: 800;
            line-height: 1;
            color: #1a3a2a;
        }

        .landing-title p {
            margin: 5px 0 0;
            font-size: clamp(11px, 3vw, 14px);
            font-weight: 600;
            opacity: 0.9;
            letter-spacing: 2px;
            color: var(--accent);
        }

        .route-card {
            background: rgba(255, 255, 255, 0.55);
            border: 1px solid rgba(41, 182, 246, 0.15);
            border-radius: 24px;
            padding: 18px 20px;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 18px;
            cursor: pointer;
            -webkit-transition: all 0.25s ease;
            transition: all 0.25s ease;
            position: relative;
            -webkit-box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .route-card:active {
            background: rgba(255, 255, 255, 0.75);
            -webkit-transform: scale(0.98);
            transform: scale(0.98);
        }

        @media (hover: hover) {
            .route-card:hover {
                background: rgba(255, 255, 255, 0.75);
                -webkit-transform: translateY(-2px);
                transform: translateY(-2px);
            }
        }

        .route-card.selected {
            border-color: var(--accent);
            background: rgba(41, 182, 246, 0.12);
            -webkit-box-shadow: 0 10px 25px rgba(41, 182, 246, 0.2);
            box-shadow: 0 10px 25px rgba(41, 182, 246, 0.2);
        }

        .card-icon {
            font-size: 26px;
            background: rgba(41, 182, 246, 0.15);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .input-group {
            margin-bottom: 18px;
            background: rgba(255, 255, 255, 0.55);
            padding: 16px;
            border-radius: 20px;
            border: 1px solid rgba(41, 182, 246, 0.2);
            -webkit-box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .input-group label {
            display: block;
            font-size: 11px;
            font-weight: 800;
            color: #0288d1;
            margin-bottom: 10px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .name-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(41, 182, 246, 0.3);
            border-radius: 14px;
            padding: 14px 18px;
            color: #1a3a2a;
            font-family: var(--font), sans-serif;
            /* CR√çTICO: m√≠nimo 16px en iOS evita el zoom autom√°tico al enfocar el input */
            font-size: 16px;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            -webkit-transition: 0.3s;
            transition: 0.3s;
            /* Permitir selecci√≥n de texto en inputs */
            -webkit-user-select: auto;
            user-select: auto;
        }

        .name-input:focus {
            border-color: var(--accent);
            background: rgba(255, 255, 255, 0.9);
            -webkit-box-shadow: 0 0 15px rgba(41, 182, 246, 0.2);
            box-shadow: 0 0 15px rgba(41, 182, 246, 0.2);
        }

        #map-view {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            z-index: 100;
            opacity: 1;
            -webkit-transition: opacity 0.5s;
            transition: opacity 0.5s;
        }

        #map-view.hidden {
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }

        .fixed-header {
            position: absolute;
            top: calc(16px + var(--safe-top));
            left: 16px;
            right: 16px;
            height: 56px;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            pointer-events: none;
        }

        .mini-logo-wrapper {
            width: 48px;
            height: 48px;
            background: white;
            border-radius: 14px;
            background-image: url('logo.jpeg');
            background-size: contain !important;
            background-position: center;
            background-repeat: no-repeat;
            border: 2px solid white;
            pointer-events: auto;
            cursor: pointer;
            -webkit-box-shadow: 0 4px 18px rgba(0, 0, 0, 0.18);
            box-shadow: 0 4px 18px rgba(0, 0, 0, 0.18);
            touch-action: manipulation;
        }

        #mini-map-container {
            position: absolute;
            bottom: 30px;
            left: 5%;
            width: 90%;
            height: 45vh;
            border-radius: 24px;
            border: 3px solid rgba(41, 182, 246, 0.35);
            background: #e0f7fa;
            -webkit-box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15);
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            z-index: 200;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
        }

        #mini-map-drag-handle {
            width: 100%;
            height: 32px;
            background: rgba(41, 182, 246, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: grab;
            flex-shrink: 0;
            touch-action: none;
        }

        .drag-bar {
            width: 40px;
            height: 5px;
            background: rgba(41, 182, 246, 0.4);
            border-radius: 4px;
        }

        #mini-map {
            width: 100%;
            flex: 1;
        }

        #search-container {
            position: absolute;
            top: calc(82px + var(--safe-top));
            left: 16px;
            right: 16px;
            z-index: 1000;
            display: none;
            flex-direction: column;
            gap: 8px;
        }

        #search-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(41, 182, 246, 0.35);
            border-radius: 18px;
            padding: 14px 20px;
            color: #1a3a2a;
            font-family: var(--font), sans-serif;
            /* 16px previene zoom en iOS */
            font-size: 16px;
            -webkit-appearance: none;
            appearance: none;
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            outline: none;
            -webkit-box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            -webkit-user-select: auto;
            user-select: auto;
        }

        #search-suggestions {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 18px;
            border: 1px solid rgba(41, 182, 246, 0.2);
            margin-top: 4px;
            overflow: hidden;
            -webkit-backdrop-filter: blur(25px);
            backdrop-filter: blur(25px);
            display: none;
            max-height: 240px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            -webkit-box-shadow: 0 12px 35px rgba(0, 0, 0, 0.13);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.13);
        }

        .suggestion-item {
            padding: 14px 20px;
            color: #1a3a2a;
            font-size: 15px;
            cursor: pointer;
            border-bottom: 1px solid rgba(41, 182, 246, 0.1);
            -webkit-transition: 0.2s background;
            transition: 0.2s background;
            display: flex;
            align-items: center;
            gap: 10px;
            touch-action: manipulation;
        }

        .suggestion-item::before {
            content: "üìç";
            font-size: 16px;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-item:active,
        .suggestion-item:hover {
            background: rgba(41, 182, 246, 0.12);
        }

        .layer-btn {
            position: absolute;
            top: calc(146px + var(--safe-top));
            right: 16px;
            z-index: 1000;
            display: none;
        }

        #onboarding-tip,
        #summary-screen {
            position: fixed;
            inset: 0;
            background: rgba(200, 230, 201, 0.85);
            z-index: 4000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: calc(40px + var(--safe-top)) 40px calc(40px + var(--safe-bottom));
            text-align: center;
            -webkit-backdrop-filter: blur(12px);
            backdrop-filter: blur(12px);
        }

        .tip-card {
            background: rgba(255, 255, 255, 0.97);
            padding: 40px 30px;
            border-radius: 32px;
            border: 1px solid rgba(41, 182, 246, 0.2);
            max-width: 340px;
            width: 100%;
            -webkit-box-shadow: 0 20px 50px rgba(0, 0, 0, 0.12);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.12);
            color: #1a3a2a;
        }

        .summary-stat {
            font-size: clamp(28px, 8vw, 36px);
            font-weight: 800;
            color: var(--accent);
            margin: 12px 0;
        }

        .controls {
            pointer-events: auto;
            display: flex;
            gap: 10px;
        }

        .ctrl-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            -webkit-backdrop-filter: blur(15px);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(41, 182, 246, 0.25);
            color: #1a3a2a;
            font-size: 17px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            pointer-events: auto;
            -webkit-box-shadow: 0 4px 15px rgba(0, 0, 0, 0.12);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.12);
            -webkit-transition: 0.2s;
            transition: 0.2s;
            font-weight: 700;
            touch-action: manipulation;
            /* Evita el delay de 300ms en iOS Safari */
            -webkit-tap-highlight-color: transparent;
        }

        .ctrl-btn:active {
            -webkit-transform: scale(0.94);
            transform: scale(0.94);
            opacity: 0.85;
        }

        @media (hover: hover) {
            .ctrl-btn:hover {
                background: rgba(255, 255, 255, 1);
                -webkit-transform: translateY(-2px);
                transform: translateY(-2px);
                -webkit-box-shadow: 0 8px 20px rgba(41, 182, 246, 0.2);
                box-shadow: 0 8px 20px rgba(41, 182, 246, 0.2);
            }
        }

        .bottom-card {
            position: absolute;
            bottom: calc(20px + var(--safe-bottom));
            left: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.96);
            border-radius: 28px;
            padding: 22px;
            border: 1px solid rgba(41, 182, 246, 0.2);
            z-index: 500;
            -webkit-backdrop-filter: blur(30px);
            backdrop-filter: blur(30px);
            -webkit-box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
        }

        .btn-start {
            width: 100%;
            background: -webkit-linear-gradient(315deg, #29b6f6, #0288d1);
            background: linear-gradient(135deg, #29b6f6, #0288d1);
            color: white;
            font-weight: 800;
            padding: 16px;
            border-radius: 18px;
            border: none;
            font-size: 15px;
            margin-top: 16px;
            cursor: pointer;
            -webkit-transition: 0.3s;
            transition: 0.3s;
            -webkit-box-shadow: 0 8px 25px rgba(41, 182, 246, 0.35);
            box-shadow: 0 8px 25px rgba(41, 182, 246, 0.35);
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            /* Prevenir que en iOS el bot√≥n se vea distinto */
            -webkit-appearance: none;
            appearance: none;
            font-family: var(--font), sans-serif;
            letter-spacing: 0.5px;
        }

        .btn-start:disabled {
            opacity: 0.45;
            background: #b0bec5;
            -webkit-box-shadow: none;
            box-shadow: none;
        }

        .btn-start:active {
            -webkit-transform: scale(0.97);
            transform: scale(0.97);
        }

        .user-marker {
            width: 20px;
            height: 20px;
            background-color: #29b6f6;
            border-radius: 50%;
            border: 3px solid #fff;
            -webkit-box-shadow: 0 0 12px rgba(41, 182, 246, 0.8);
            box-shadow: 0 0 12px rgba(41, 182, 246, 0.8);
            -webkit-animation: pulse 2s infinite;
            animation: pulse 2s infinite;
        }

        @-webkit-keyframes pulse {
            0% {
                -webkit-box-shadow: 0 0 0 0 rgba(41, 182, 246, 0.7);
            }

            70% {
                -webkit-box-shadow: 0 0 0 16px rgba(41, 182, 246, 0);
            }

            100% {
                -webkit-box-shadow: 0 0 0 0 rgba(41, 182, 246, 0);
            }
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(41, 182, 246, 0.7);
            }

            70% {
                box-shadow: 0 0 0 16px rgba(41, 182, 246, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(41, 182, 246, 0);
            }
        }

        /* ============================================================
           NAVIGATION VIEW (sin c√°mara, tipo Google Maps)
        ============================================================ */
        #ar-view {
            position: fixed;
            inset: 0;
            z-index: 50;
            visibility: hidden;
            opacity: 0;
            -webkit-transition: opacity 0.5s;
            transition: opacity 0.5s;
            background: linear-gradient(160deg, #c8e6c9 0%, #e0f2f1 100%);
        }

        #ar-view.visible {
            display: block !important;
            visibility: visible;
            opacity: 1;
        }

        #nav-map {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
        }

        .nav-hud {
            position: absolute;
            padding: calc(12px + var(--safe-top)) 16px 0;
            inset: 0;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            z-index: 1000;
        }

        .nav-top {
            margin-top: 0;
            display: flex;
            justify-content: space-between;
            pointer-events: auto;
            z-index: 1001;
            align-items: flex-start;
        }

        .instr-box {
            background: rgba(255, 255, 255, 0.97);
            padding: 14px 20px;
            border-radius: 20px;
            border: 1px solid rgba(41, 182, 246, 0.2);
            border-left: 5px solid var(--accent);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            -webkit-box-shadow: 0 6px 24px rgba(0, 0, 0, 0.1);
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.1);
            max-width: 70%;
            flex: 1;
        }

        .big-instr {
            font-size: clamp(16px, 4.5vw, 22px);
            font-weight: 800;
            color: #1a3a2a;
            margin-bottom: 4px;
            line-height: 1.2;
        }

        .nav-bottom-card {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 28px 28px 0 0;
            /* Ajuste para barra de inicio de iPhone X+ */
            padding: 20px 22px calc(22px + var(--safe-bottom));
            border-top: 2px solid rgba(41, 182, 246, 0.2);
            z-index: 500;
            -webkit-box-shadow: 0 -6px 24px rgba(0, 0, 0, 0.08);
            box-shadow: 0 -6px 24px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .nav-arrive-banner {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .nav-arrive-icon {
            font-size: 28px;
        }

        .nav-arrive-label {
            font-size: 12px;
            font-weight: 700;
            color: #0288d1;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .nav-arrive-time {
            font-size: clamp(24px, 7vw, 32px);
            font-weight: 800;
            color: #1a3a2a;
            line-height: 1.1;
        }

        .nav-arrive-dist {
            font-size: 13px;
            color: #546e7a;
            font-weight: 600;
        }

        .nav-stop-btn {
            width: 100%;
            background: -webkit-linear-gradient(315deg, #ef5350, #c62828);
            background: linear-gradient(135deg, #ef5350, #c62828);
            color: white;
            font-weight: 800;
            padding: 15px;
            border-radius: 18px;
            border: none;
            font-size: 15px;
            cursor: pointer;
            -webkit-transition: 0.25s;
            transition: 0.25s;
            -webkit-box-shadow: 0 6px 20px rgba(239, 83, 80, 0.3);
            box-shadow: 0 6px 20px rgba(239, 83, 80, 0.3);
            margin-top: 2px;
            touch-action: manipulation;
            -webkit-appearance: none;
            appearance: none;
            font-family: var(--font), sans-serif;
        }

        .nav-stop-btn:active {
            -webkit-transform: scale(0.97);
            transform: scale(0.97);
        }

        /* ============================================================
           RESPONSIVE: pantallas peque√±as (iPhone SE, etc.)
        ============================================================ */
        @media screen and (max-height: 680px) {
            .route-card {
                padding: 14px 16px;
                margin-bottom: 10px;
            }

            .input-group {
                padding: 12px;
                margin-bottom: 12px;
            }

            .landing-header {
                margin-bottom: 16px;
            }

            .big-logo {
                width: 60px;
                height: 60px;
            }

            .nav-arrive-time {
                font-size: 24px;
            }
        }

        /* Pantallas anchas (tablets, desktop) */
        @media screen and (min-width: 600px) {
            #landing-overlay {
                padding-left: max(30px, 10%);
                padding-right: max(30px, 10%);
            }

            .bottom-card,
            .nav-bottom-card {
                left: max(16px, 10%);
                right: max(16px, 10%);
            }

            .instr-box {
                max-width: 60%;
            }
        }

        /* Modo oscuro del sistema (respeta preferencia del usuario) */
        @media (prefers-color-scheme: dark) {
            /* Mantenemos el tema claro por dise√±o de la app */
        }

        /* Reducir animaciones si el usuario lo prefiere */
        @media (prefers-reduced-motion: reduce) {

            *,
            *::before,
            *::after {
                -webkit-animation-duration: 0.01ms !important;
                animation-duration: 0.01ms !important;
                -webkit-transition-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>

<body>

    <div id="loader">
        <div class="spinner"></div>
        <div style="font-size:13px; letter-spacing:3px; color:var(--accent); font-weight: 600;">CARGANDO...</div>
    </div>

    <div id="landing-overlay">
        <div class="landing-header">
            <div class="big-logo"></div>
            <div class="landing-title">
                <h1>BAJASTAY</h1>
                <p>RENTALS</p>
            </div>
            <button class="ctrl-btn"
                style="margin-left: auto; width: 44px; height: 44px; font-size: 15px; background: rgba(255,255,255,0.7);"
                id="btn-lang-landing" onclick="handleLangToggle(event)">ES</button>
        </div>

        <div style="flex:1; overflow-y: auto;">
            <div class="input-group">
                <label id="lbl-name">Tu Nombre</label>
                <input type="text" id="user-name" class="name-input" placeholder="¬øC√≥mo te llamas?" autocomplete="off">
            </div>

            <p id="lbl-select-route"
                style="margin-bottom:20px; font-size:13px; font-weight:800; color:#0288d1; text-align: center;">
                SELECCIONA TU RUTA</p>

            <div class="route-card selected" id="opt-lapaz" onclick="selectRouteType('lapaz')">
                <div class="card-icon">‚úàÔ∏è</div>
                <div>
                    <h3 id="lbl-route-lapaz" style="margin:0; font-size:19px; color: #1a3a2a;">Ruta La Paz</h3>
                    <p id="lbl-desc-lapaz" style="margin:6px 0 0; font-size:14px; opacity:0.65; color:#1a3a2a;">
                        Aeropuerto LAP ‚ûú
                        BajaStay</p>
                </div>
            </div>

            <div class="route-card" id="opt-sjc" onclick="selectRouteType('sjc')">
                <div class="card-icon">üå¥</div>
                <div>
                    <h3 id="lbl-route-sjc" style="margin:0; font-size:19px; color: #1a3a2a;">Ruta San Jos√©</h3>
                    <p id="lbl-desc-sjc" style="margin:6px 0 0; font-size:14px; opacity:0.65; color:#1a3a2a;">
                        Aeropuerto
                        SJC ‚ûú BajaStay
                    </p>
                </div>
            </div>

            <div class="route-card" id="opt-manual" onclick="selectRouteType('manual')">
                <div class="card-icon">üó∫Ô∏è</div>
                <div>
                    <h3 id="lbl-route-manual" style="margin:0; font-size:19px; color: #1a3a2a;">Ruta Manual</h3>
                    <p id="lbl-desc-manual" style="margin:6px 0 0; font-size:14px; opacity:0.65; color:#1a3a2a;">
                        Busca
                        destino o toca el
                        mapa</p>
                </div>
            </div>
        </div>

        <button class="btn-start" onclick="confirmSelection()" id="btn-confirm">COMENZAR EXPERIENCIA</button>
    </div>

    <div id="map-view">
        <div class="fixed-header">
            <div class="mini-logo-wrapper" onclick="forceStopAndShowLanding()"></div>
            <div class="controls">
                <button class="ctrl-btn" id="btn-lang" onclick="handleLangToggle()">ES</button>
                <button class="ctrl-btn" onclick="forceStopAndShowLanding()">‚öôÔ∏è</button>
            </div>
        </div>

        <div id="search-container">
            <input type="text" id="search-input" placeholder="Buscar direcci√≥n o lugar..."
                oninput="handleSearchInput(this.value)" autocomplete="off">
            <div id="search-suggestions"></div>
        </div>

        <button class="ctrl-btn layer-btn" id="btn-layer" onclick="toggleStyle()">üõ∞Ô∏è</button>

        <div id="map" style="flex:1;"></div>

        <div class="bottom-card">
            <div style="display:flex; justify-content:space-between; align-items:flex-end;">
                <div>
                    <div id="lbl-dest-title"
                        style="font-size:12px; color:#0288d1; font-weight:800; letter-spacing: 1px;">
                        DESTINO</div>
                    <div style="font-size:24px; font-weight:800; margin-top:4px; color:#1a3a2a;" id="txt-dest-name">
                        ...
                    </div>
                </div>
                <div style="text-align:right;">
                    <div style="font-size:26px; font-weight:800; color:#0288d1;" id="txt-time">--</div>
                    <div style="font-size:13px; color:#546e7a; font-weight: 600;" id="txt-dist">--</div>
                    <div style="display:none;" id="lbl-time-title">TIEMPO</div>
                    <div style="display:none;" id="lbl-dist-title">DISTANCIA</div>
                </div>
            </div>
            <button class="btn-start" id="btn-go" onclick="attemptStartAR()" disabled>INICIAR RUTA</button>
            <p style="font-size:12px; opacity:0.6; text-align:center; margin-top:15px; display:none; font-weight: 600; color:#1a3a2a;"
                id="manual-tip">
                Toca el mapa para a√±adir puntos</p>
        </div>
    </div>

    <div id="onboarding-tip" onclick="this.style.display='none'">
        <div class="tip-card">
            <div style="font-size:45px; margin-bottom:25px;">üó∫Ô∏è</div>
            <h2 id="lbl-ob-title" style="margin:0 0 15px 0; font-size: 26px;">Modo Manual</h2>
            <p id="lbl-ob-desc" style="font-size:15px; opacity:0.8; margin-bottom:30px; line-height: 1.5;">Busca un
                lugar en la barra superior o toca puntos en el mapa para trazar tu propia ruta personalizada desde
                donde
                est√©s.</p>
            <button id="btn-ob" class="btn-start"
                style="margin:0; background: var(--accent); color: white;">ENTENDIDO</button>
        </div>
    </div>

    <div id="summary-screen">
        <div style="font-size:65px; margin-bottom:25px;">üèÅ</div>
        <h1 id="lbl-sum-title" style="font-size: 32px; margin-bottom: 10px;">¬°Has llegado!</h1>
        <p id="lbl-sum-desc" style="opacity:0.8; margin-bottom:45px; font-size: 16px;">Esperamos que disfrutes tu
            estancia en BajaStay.</p>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; width:100%; margin-bottom:45px;">
            <div>
                <div style="font-size:12px; opacity:0.6; font-weight: 800; letter-spacing: 1px;">DISTANCIA</div>
                <div class="summary-stat" id="sum-dist">-- km</div>
            </div>
            <div>
                <div style="font-size:12px; opacity:0.6; font-weight: 800; letter-spacing: 1px;">TIEMPO</div>
                <div class="summary-stat" id="sum-time">-- min</div>
            </div>
        </div>
        <button id="btn-sum" class="btn-start" onclick="location.reload()">VOLVER AL INICIO</button>
    </div>

    <div id="ar-view">
        <!-- Mapa de navegaci√≥n a pantalla completa (sin c√°mara) -->
        <div id="nav-map"></div>

        <div class="nav-hud">
            <!-- HUD superior: instrucci√≥n de giro + controles -->
            <div class="nav-top">
                <div class="instr-box">
                    <div class="big-instr" id="ar-instr">Iniciando...</div>
                    <div style="font-size:14px; font-weight:700; color:#0288d1;" id="ar-stats">
                        <span id="ar-next-dist">--</span> ¬∑ <span id="ar-next-time">--</span>
                    </div>
                </div>
                <div style="display:flex; flex-direction:column; gap:12px; padding-right:10px; align-items:flex-end;">
                    <button class="ctrl-btn" id="btn-lang-ar" onclick="handleLangToggle()">ES</button>
                    <button class="ctrl-btn" id="btn-voice" onclick="handleVoiceToggle()">üîä</button>
                    <button class="ctrl-btn" style="background:#ef5350; border-color:#ef5350; color:white;"
                        onclick="stopAR()">‚úï</button>
                </div>
            </div>

            <!-- Panel inferior estilo Google Maps con tiempo/distancia reales -->
            <div class="nav-bottom-card">
                <div class="nav-arrive-banner">
                    <div class="nav-arrive-icon">üß≠</div>
                    <div>
                        <div class="nav-arrive-label" id="nav-label-eta">TIEMPO ESTIMADO</div>
                        <div class="nav-arrive-time" id="ar-next-time-big">--</div>
                        <div class="nav-arrive-dist" id="ar-next-dist-big">Calculando distancia...</div>
                    </div>
                </div>
                <button class="nav-stop-btn" onclick="stopAR()">‚èπ Finalizar Navegaci√≥n</button>
            </div>
        </div>
    </div>

    <script>
        // --- CONFIG ---
        mapboxgl.accessToken = 'pk.eyJ1IjoiYW5keWc5NyIsImEiOiJjbWpwN20zcGoyYjFzM2ZveTIzZ2s5Mm56In0.FsNncSP8DrD6zTXpw0MaEg';

        const ROUTE_LA_PAZ = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "geometry": { "type": "Point", "coordinates": [-110.3675884755777, 24.07620957367486, 19.59901810551265] },
                    "properties": { "name": "Origen - Aeropuerto la Paz" }
                },
                {
                    "type": "Feature",
                    "geometry": { "type": "Point", "coordinates": [-110.391038445351, 24.09540285146841, 4.487690660529326] },
                    "properties": { "name": "Destino - Airbnb BajaStays Rentals" }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "LineString",
                        "coordinates": [
                            [-110.3676061849273, 24.07622858497015, 0], [-110.3675472830153, 24.07661897630843, 0], [-110.3677690683074, 24.0768711004984, 0],
                            [-110.3688447687849, 24.07702726387739, 0], [-110.3691804052901, 24.07719566737829, 0], [-110.3693387833746, 24.07768299232134, 0],
                            [-110.3693291883587, 24.07792177827368, 0], [-110.3665929537034, 24.10371032330687, 0], [-110.3664918936345, 24.10510869981672, 0],
                            [-110.3664107193627, 24.10556814346124, 0], [-110.3661028090201, 24.10626749746943, 0], [-110.3655477373088, 24.10681103355262, 0],
                            [-110.3651509852586, 24.10704606986485, 0], [-110.3649707532042, 24.10708111685407, 0], [-110.3647205936599, 24.10694809684832, 0],
                            [-110.3646534678784, 24.10671941561371, 0], [-110.3647690908585, 24.10652723707523, 0], [-110.3651616586128, 24.10634409139388, 0],
                            [-110.3667445092549, 24.10563801417024, 0], [-110.3803260784353, 24.0999716297604, 0], [-110.3821653573059, 24.09923618643921, 0],
                            [-110.3930933118167, 24.09772319671085, 0]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "geometry": {
                        "type": "LineString",
                        "coordinates": [
                            [-110.3930436743562, 24.09754761703125, 0], [-110.3928194657311, 24.0962260369505, 0], [-110.3926876313522, 24.09618915901778, 0],
                            [-110.3923589171539, 24.09620761028096, 0], [-110.3922991407109, 24.09615135129986, 0], [-110.392173137542, 24.09518587995925, 0],
                            [-110.3910261027907, 24.09532131661534, 0], [-110.3910372199984, 24.09539877384319, 0]
                        ]
                    }
                }
            ]
        };

        // =========================================================================================
        // AQUI PEGA EL CODIGO GIGANTE DE LA RUTA DE SAN JOSE QUE TENIAS EN TU ARCHIVO ORIGINAL
        // =========================================================================================
        const ROUTE_SJC = {
            "type": "FeatureCollection", "features": [{ "type": "Feature", "geometry": { "type": "LineString", "coordinates": [[-109.71631, 23.15805, 0], [-109.71598, 23.15527, 0], [-109.71596, 23.1552, 0], [-109.71594, 23.15517, 0], [-109.71591, 23.15515, 0], [-109.71588, 23.15514, 0], [-109.71583, 23.15513, 0], [-109.71518, 23.15522, 0], [-109.71514, 23.15524, 0], [-109.71511, 23.15526, 0], [-109.71508, 23.1553, 0], [-109.71507, 23.15534, 0], [-109.71507, 23.15538, 0], [-109.71533, 23.15768, 0], [-109.71545, 23.15893, 0], [-109.7155, 23.15934, 0], [-109.7155, 23.1594, 0], [-109.71549, 23.15945, 0], [-109.71547, 23.1595, 0], [-109.71539, 23.15976, 0], [-109.71539, 23.15986, 0], [-109.7154, 23.15999, 0], [-109.71558, 23.16142, 0], [-109.7157, 23.16256, 0], [-109.7157, 23.16259, 0], [-109.71569, 23.16262, 0], [-109.71565, 23.16265, 0], [-109.71562, 23.16273, 0], [-109.71559, 23.16276, 0], [-109.71551, 23.16282, 0], [-109.71537, 23.16287, 0], [-109.71524, 23.16294, 0], [-109.71519, 23.163, 0], [-109.71516, 23.16306, 0], [-109.71514, 23.16313, 0], [-109.71513, 23.16318, 0], [-109.71513, 23.1634, 0], [-109.71522, 23.16372, 0], [-109.71522, 23.16391, 0], [-109.71535, 23.16494, 0], [-109.71537, 23.16499, 0], [-109.71557, 23.16676, 0], [-109.71559, 23.16686, 0], [-109.7156, 23.16695, 0], [-109.71565, 23.16714, 0], [-109.7157, 23.16729, 0], [-109.71575, 23.16738, 0], [-109.7158, 23.16749, 0], [-109.71586, 23.16759, 0], [-109.71595, 23.16772, 0], [-109.71604, 23.16782, 0], [-109.71629, 23.16805, 0], [-109.71634, 23.16808, 0], [-109.71642, 23.16814, 0], [-109.71649, 23.16818, 0], [-109.71655, 23.16822, 0], [-109.71673, 23.16831, 0], [-109.71679, 23.16833, 0], [-109.717, 23.16842, 0], [-109.71715, 23.16846, 0], [-109.7173, 23.16849, 0], [-109.71745, 23.16851, 0], [-109.71764, 23.16851, 0], [-109.71806, 23.16849, 0], [-109.71957, 23.16834, 0], [-109.7196, 23.16834, 0], [-109.72499, 23.16781, 0], [-109.72505, 23.16781, 0], [-109.72524, 23.16779, 0], [-109.72544, 23.16776, 0], [-109.72943, 23.16734, 0], [-109.73093, 23.1672, 0], [-109.73108, 23.16718, 0], [-109.73341, 23.16695, 0], [-109.7336, 23.16694, 0], [-109.73497, 23.1668, 0], [-109.73592, 23.16672, 0], [-109.73634, 23.16667, 0], [-109.73689, 23.16658, 0], [-109.73716, 23.16651, 0], [-109.73753, 23.1664, 0], [-109.73785, 23.16627, 0], [-109.73806, 23.16617, 0], [-109.7383, 23.16603, 0], [-109.73864, 23.1658, 0], [-109.73865, 23.16579, 0], [-109.7388, 23.16569, 0], [-109.73885, 23.16565, 0], [-109.73917, 23.16535, 0], [-109.73951, 23.16498, 0], [-109.7398, 23.16457, 0], [-109.73995, 23.16428, 0], [-109.74003, 23.1641, 0], [-109.74013, 23.16382, 0], [-109.74021, 23.16354, 0], [-109.74029, 23.16311, 0], [-109.74035, 23.1625, 0], [-109.74035, 23.16239, 0], [-109.74043, 23.16063, 0], [-109.74053, 23.15582, 0], [-109.74059, 23.15419, 0], [-109.74058, 23.15393, 0], [-109.74064, 23.15211, 0], [-109.74063, 23.15196, 0], [-109.74057, 23.1514, 0], [-109.74055, 23.15103, 0], [-109.74055, 23.15077, 0], [-109.74059, 23.15073, 0], [-109.74059, 23.15072, 0], [-109.7406, 23.15071, 0], [-109.74061, 23.15046, 0], [-109.74061, 23.15021, 0], [-109.7406, 23.15019, 0], [-109.74058, 23.15017, 0], [-109.74056, 23.15016, 0], [-109.74057, 23.14988, 0], [-109.74069, 23.14903, 0], [-109.74072, 23.14863, 0], [-109.74077, 23.1466, 0], [-109.74081, 23.14567, 0], [-109.74082, 23.14458, 0], [-109.74095, 23.14, 0], [-109.74101, 23.13676, 0], [-109.74107, 23.13542, 0], [-109.74107, 23.13522, 0], [-109.74108, 23.135, 0], [-109.74108, 23.13424, 0], [-109.74109, 23.13396, 0], [-109.74109, 23.1336, 0], [-109.74111, 23.13342, 0], [-109.74111, 23.13337, 0], [-109.74114, 23.13306, 0], [-109.74115, 23.13288, 0], [-109.74123, 23.13217, 0], [-109.74134, 23.13161, 0], [-109.74147, 23.13086, 0], [-109.7417, 23.12987, 0], [-109.74184, 23.12937, 0], [-109.74195, 23.12889, 0], [-109.74205, 23.12854, 0], [-109.74205, 23.12851, 0], [-109.74213, 23.12822, 0], [-109.74219, 23.12795, 0], [-109.74308, 23.12451, 0], [-109.74318, 23.12409, 0], [-109.7435, 23.12303, 0], [-109.7437, 23.12219, 0], [-109.74371, 23.12218, 0], [-109.74399, 23.1211, 0], [-109.74409, 23.12065, 0], [-109.74429, 23.11957, 0], [-109.74438, 23.11899, 0], [-109.74441, 23.11873, 0], [-109.74444, 23.11835, 0], [-109.74448, 23.11798, 0], [-109.74449, 23.11794, 0], [-109.7445, 23.11783, 0], [-109.7445, 23.11776, 0], [-109.74452, 23.11751, 0], [-109.74454, 23.11734, 0], [-109.74455, 23.11692, 0], [-109.7446, 23.116, 0], [-109.74463, 23.11567, 0], [-109.74466, 23.11456, 0], [-109.74471, 23.11399, 0], [-109.74471, 23.11385, 0], [-109.74472, 23.11376, 0], [-109.74472, 23.11363, 0], [-109.74481, 23.11183, 0], [-109.74481, 23.11165, 0], [-109.745, 23.1078, 0], [-109.74507, 23.10693, 0], [-109.74507, 23.10645, 0], [-109.7451, 23.10558, 0], [-109.74512, 23.1053, 0], [-109.74512, 23.10522, 0], [-109.74515, 23.10481, 0], [-109.74524, 23.10426, 0], [-109.74524, 23.10415, 0], [-109.74525, 23.1041, 0], [-109.74522, 23.10362, 0], [-109.74522, 23.10289, 0], [-109.74526, 23.10214, 0], [-109.74533, 23.10121, 0], [-109.74533, 23.10115, 0], [-109.74548, 23.09906, 0], [-109.74548, 23.0988, 0], [-109.74547, 23.09858, 0], [-109.74547, 23.09804, 0], [-109.74548, 23.09786, 0], [-109.74548, 23.09779, 0], [-109.7455, 23.09754, 0], [-109.74556, 23.09708, 0], [-109.74558, 23.09658, 0], [-109.74555, 23.09622, 0], [-109.74556, 23.09583, 0], [-109.74558, 23.09557, 0], [-109.74566, 23.09495, 0], [-109.7457, 23.09409, 0], [-109.74572, 23.09391, 0], [-109.74572, 23.09358, 0], [-109.7457, 23.09337, 0], [-109.74569, 23.09319, 0], [-109.74567, 23.09301, 0], [-109.74566, 23.09284, 0], [-109.74567, 23.09243, 0], [-109.74574, 23.09122, 0], [-109.74583, 23.09052, 0], [-109.74583, 23.0905, 0], [-109.74594, 23.08954, 0], [-109.74594, 23.08907, 0], [-109.74592, 23.08856, 0], [-109.74595, 23.08803, 0], [-109.74605, 23.08718, 0], [-109.74608, 23.08677, 0], [-109.74608, 23.08674, 0], [-109.74611, 23.08634, 0], [-109.74612, 23.08537, 0], [-109.74619, 23.08373, 0], [-109.74618, 23.08327, 0], [-109.74619, 23.08297, 0], [-109.74635, 23.08014, 0], [-109.74635, 23.07996, 0], [-109.7464, 23.07889, 0], [-109.74654, 23.07664, 0], [-109.74655, 23.07521, 0], [-109.7466, 23.07486, 0], [-109.74666, 23.0739, 0], [-109.74666, 23.0736, 0], [-109.74671, 23.07353, 0], [-109.74674, 23.07347, 0], [-109.74677, 23.07342, 0], [-109.74717, 23.07232, 0], [-109.74772, 23.07115, 0], [-109.74792, 23.07076, 0], [-109.7483, 23.06993, 0], [-109.74861, 23.0693, 0], [-109.74862, 23.06927, 0], [-109.74888, 23.06871, 0], [-109.74942, 23.06772, 0], [-109.74964, 23.06735, 0], [-109.74973, 23.06724, 0], [-109.74985, 23.06702, 0], [-109.75008, 23.06666, 0], [-109.75037, 23.06623, 0], [-109.7504, 23.0662, 0], [-109.7505, 23.06605, 0], [-109.7512, 23.06509, 0], [-109.75126, 23.065, 0], [-109.75131, 23.06494, 0], [-109.75137, 23.06485, 0], [-109.75142, 23.06479, 0], [-109.75186, 23.0642, 0], [-109.75192, 23.06411, 0], [-109.75197, 23.06405, 0], [-109.75203, 23.06396, 0], [-109.75369, 23.06168, 0], [-109.7537, 23.06167, 0], [-109.75388, 23.06142, 0], [-109.75391, 23.06137, 0], [-109.75455, 23.06047, 0], [-109.75462, 23.06036, 0], [-109.75466, 23.06032, 0], [-109.75476, 23.06017, 0], [-109.75477, 23.06015, 0], [-109.75526, 23.05939, 0], [-109.75532, 23.05928, 0], [-109.75535, 23.05924, 0], [-109.7558, 23.05854, 0], [-109.75693, 23.05661, 0], [-109.75695, 23.05657, 0], [-109.75703, 23.05645, 0], [-109.75705, 23.05641, 0], [-109.7575, 23.05566, 0], [-109.7576, 23.05551, 0], [-109.75762, 23.05547, 0], [-109.758, 23.05485, 0], [-109.75807, 23.05472, 0], [-109.75809, 23.05469, 0], [-109.7581, 23.05469, 0], [-109.75817, 23.05456, 0], [-109.75819, 23.05453, 0], [-109.75826, 23.0544, 0], [-109.75828, 23.05438, 0], [-109.75901, 23.05314, 0], [-109.75903, 23.05312, 0], [-109.7592, 23.05283, 0], [-109.75921, 23.0528, 0], [-109.76118, 23.04952, 0], [-109.76127, 23.04936, 0], [-109.76128, 23.04935, 0], [-109.76334, 23.04589, 0], [-109.76351, 23.04562, 0], [-109.7636, 23.04545, 0], [-109.76382, 23.04511, 0], [-109.76389, 23.04499, 0], [-109.76402, 23.0448, 0], [-109.76409, 23.04468, 0], [-109.76411, 23.04464, 0], [-109.76431, 23.04433, 0], [-109.76432, 23.04432, 0], [-109.76439, 23.04422, 0], [-109.76451, 23.04402, 0], [-109.76472, 23.04372, 0], [-109.76472, 23.04371, 0], [-109.76492, 23.04346, 0], [-109.76494, 23.04342, 0], [-109.76503, 23.04331, 0], [-109.76506, 23.04328, 0], [-109.76542, 23.04283, 0], [-109.7655, 23.04274, 0], [-109.76554, 23.04271, 0], [-109.76603, 23.04221, 0], [-109.7662, 23.04205, 0], [-109.76657, 23.04173, 0], [-109.76711, 23.04133, 0], [-109.76756, 23.04102, 0], [-109.76813, 23.04065, 0], [-109.76855, 23.04043, 0], [-109.76902, 23.0402, 0], [-109.76947, 23.04002, 0], [-109.77051, 23.03965, 0], [-109.77058, 23.03962, 0], [-109.77065, 23.0396, 0], [-109.77069, 23.03958, 0], [-109.77083, 23.03953, 0], [-109.77087, 23.03951, 0], [-109.77101, 23.03946, 0], [-109.77106, 23.03945, 0], [-109.77468, 23.03813, 0], [-109.77666, 23.03733, 0], [-109.77679, 23.03727, 0], [-109.77712, 23.03714, 0], [-109.7791, 23.0363, 0], [-109.78144, 23.03527, 0], [-109.7815, 23.03524, 0], [-109.7832, 23.03449, 0], [-109.78335, 23.03443, 0], [-109.78479, 23.0338, 0], [-109.78497, 23.03373, 0], [-109.78532, 23.03357, 0], [-109.78568, 23.03342, 0], [-109.78846, 23.03218, 0], [-109.79096, 23.03118, 0], [-109.79097, 23.03118, 0], [-109.79187, 23.03085, 0], [-109.79254, 23.03063, 0], [-109.79802, 23.02903, 0], [-109.80045, 23.02835, 0], [-109.80064, 23.02829, 0], [-109.80478, 23.02713, 0], [-109.80649, 23.02661, 0], [-109.80815, 23.02605, 0], [-109.81116, 23.02495, 0], [-109.81135, 23.02489, 0], [-109.81156, 23.02481, 0], [-109.81262, 23.02444, 0], [-109.81281, 23.02438, 0], [-109.81401, 23.02396, 0], [-109.81409, 23.02394, 0], [-109.8157, 23.02338, 0], [-109.81675, 23.02295, 0], [-109.81766, 23.0225, 0], [-109.81833, 23.02212, 0], [-109.81908, 23.02164, 0], [-109.82007, 23.02087, 0], [-109.82193, 23.01928, 0], [-109.82519, 23.01643, 0], [-109.82534, 23.01631, 0], [-109.82665, 23.01519, 0], [-109.82924, 23.01305, 0], [-109.82934, 23.01296, 0], [-109.83724, 23.00671, 0], [-109.83739, 23.0066, 0], [-109.83828, 23.0059, 0], [-109.84282, 23.0022, 0], [-109.84291, 23.00212, 0], [-109.84311, 23.00196, 0], [-109.84538, 23.00002, 0], [-109.84828, 22.99728, 0], [-109.84846, 22.9971, 0], [-109.8529, 22.99288, 0], [-109.85451, 22.99132, 0], [-109.8577, 22.98831, 0], [-109.85798, 22.98806, 0], [-109.85861, 22.98745, 0], [-109.85865, 22.9874, 0], [-109.85878, 22.98727, 0], [-109.85887, 22.98719, 0], [-109.85919, 22.98688, 0], [-109.85928, 22.9868, 0], [-109.85932, 22.98675, 0], [-109.85941, 22.98666, 0], [-109.85946, 22.98662, 0], [-109.85999, 22.9861, 0], [-109.86005, 22.98605, 0], [-109.86211, 22.98406, 0], [-109.86216, 22.98402, 0], [-109.86333, 22.9829, 0], [-109.86337, 22.98285, 0], [-109.86418, 22.98207, 0], [-109.86431, 22.98196, 0], [-109.86603, 22.9803, 0], [-109.86608, 22.98026, 0], [-109.8663, 22.98004, 0], [-109.86635, 22.98, 0], [-109.86723, 22.97914, 0], [-109.86975, 22.97677, 0], [-109.87068, 22.97592, 0], [-109.87109, 22.97564, 0], [-109.87156, 22.97534, 0], [-109.87203, 22.97509, 0], [-109.87212, 22.97505, 0], [-109.8722, 22.97502, 0], [-109.87271, 22.97479, 0], [-109.87286, 22.97475, 0], [-109.87319, 22.97464, 0], [-109.8732, 22.97464, 0], [-109.87387, 22.97446, 0], [-109.87474, 22.97429, 0], [-109.87481, 22.97427, 0], [-109.8749, 22.97425, 0], [-109.87493, 22.97425, 0], [-109.87834, 22.97356, 0], [-109.87837, 22.97355, 0], [-109.87939, 22.97335, 0], [-109.87951, 22.97332, 0], [-109.88531, 22.97214, 0], [-109.88537, 22.97212, 0], [-109.8957, 22.97003, 0], [-109.89627, 22.96993, 0], [-109.89656, 22.96989, 0], [-109.89696, 22.96985, 0], [-109.89728, 22.96983, 0], [-109.89762, 22.96982, 0], [-109.89822, 22.96982, 0], [-109.89919, 22.96987, 0], [-109.90415, 22.97035, 0], [-109.90455, 22.97038, 0], [-109.90504, 22.97043, 0], [-109.90512, 22.97043, 0], [-109.90523, 22.97044, 0], [-109.90525, 22.97045, 0], [-109.90585, 22.9705, 0], [-109.90591, 22.97051, 0], [-109.9062, 22.97054, 0], [-109.90622, 22.97054, 0], [-109.91106, 22.97103, 0], [-109.91115, 22.97103, 0], [-109.91488, 22.97138, 0], [-109.91503, 22.9714, 0], [-109.91523, 22.97141, 0], [-109.91527, 22.97142, 0], [-109.91533, 22.97142, 0], [-109.91542, 22.97143, 0], [-109.91546, 22.97144, 0], [-109.91553, 22.97144, 0], [-109.92222, 22.97208, 0], [-109.92242, 22.97209, 0], [-109.92494, 22.97234, 0], [-109.92502, 22.97234, 0], [-109.92505, 22.97235, 0], [-109.92514, 22.97236, 0], [-109.92521, 22.97236, 0], [-109.92593, 22.97243, 0], [-109.92595, 22.97243, 0], [-109.93107, 22.97292, 0], [-109.93119, 22.97294, 0], [-109.93286, 22.9731, 0], [-109.93292, 22.9731, 0], [-109.93346, 22.97315, 0], [-109.93348, 22.97316, 0], [-109.93358, 22.97317, 0], [-109.93367, 22.97317, 0], [-109.93377, 22.97318, 0], [-109.93383, 22.97319, 0], [-109.93387, 22.97319, 0], [-109.93403, 22.97321, 0], [-109.93422, 22.97322, 0], [-109.93473, 22.97327, 0], [-109.93564, 22.97328, 0], [-109.93653, 22.97323, 0], [-109.93697, 22.97318, 0], [-109.93751, 22.97309, 0], [-109.93813, 22.97296, 0], [-109.9385, 22.97286, 0], [-109.9397, 22.97247, 0], [-109.9403, 22.97221, 0], [-109.94069, 22.97201, 0], [-109.94072, 22.97199, 0], [-109.9408, 22.97196, 0], [-109.94089, 22.97191, 0], [-109.94092, 22.9719, 0], [-109.94097, 22.97187, 0], [-109.94107, 22.97182, 0], [-109.94108, 22.97181, 0], [-109.94126, 22.97172, 0], [-109.94252, 22.97102, 0], [-109.94258, 22.97098, 0], [-109.94263, 22.97096, 0], [-109.94324, 22.97061, 0], [-109.94415, 22.97011, 0], [-109.94425, 22.97006, 0], [-109.94434, 22.97, 0], [-109.9444, 22.96997, 0], [-109.94441, 22.96997, 0], [-109.94458, 22.96987, 0], [-109.9455, 22.96938, 0], [-109.94551, 22.96937, 0], [-109.94559, 22.96933, 0], [-109.9456, 22.96932, 0], [-109.94574, 22.96925, 0], [-109.94584, 22.96919, 0], [-109.94684, 22.96864, 0], [-109.95144, 22.9662, 0], [-109.95158, 22.96612, 0], [-109.95161, 22.96611, 0], [-109.95274, 22.96551, 0], [-109.95293, 22.9654, 0], [-109.95296, 22.96539, 0], [-109.95296, 22.96538, 0], [-109.95343, 22.96513, 0], [-109.9538, 22.96492, 0], [-109.95394, 22.96485, 0], [-109.95781, 22.96275, 0], [-109.95784, 22.96274, 0], [-109.95801, 22.96265, 0], [-109.95805, 22.96262, 0], [-109.96084, 22.96112, 0], [-109.96087, 22.9611, 0], [-109.96101, 22.96103, 0], [-109.96104, 22.96101, 0], [-109.96392, 22.95945, 0], [-109.96664, 22.95801, 0], [-109.9713, 22.95549, 0], [-109.97133, 22.95547, 0], [-109.97147, 22.9554, 0], [-109.9715, 22.95538, 0], [-109.9726, 22.95478, 0], [-109.9735, 22.95421, 0], [-109.97357, 22.95418, 0], [-109.97371, 22.95411, 0], [-109.97378, 22.95409, 0], [-109.97396, 22.954, 0], [-109.97397, 22.954, 0], [-109.97412, 22.95392, 0], [-109.97414, 22.9539, 0], [-109.97415, 22.95388, 0], [-109.97429, 22.9538, 0], [-109.97432, 22.95379, 0], [-109.97449, 22.95369, 0], [-109.97556, 22.95318, 0], [-109.98129, 22.95011, 0], [-109.98497, 22.94827, 0], [-109.98545, 22.94799, 0], [-109.98575, 22.94779, 0], [-109.98591, 22.94766, 0], [-109.98622, 22.94737, 0], [-109.98637, 22.94722, 0], [-109.98649, 22.94709, 0], [-109.98744, 22.94592, 0], [-109.98757, 22.94583, 0], [-109.98793, 22.94541, 0], [-109.98813, 22.94516, 0], [-109.98843, 22.94481, 0], [-109.98853, 22.94468, 0], [-109.98864, 22.94456, 0], [-109.98875, 22.94446, 0], [-109.98884, 22.94437, 0], [-109.98893, 22.94429, 0], [-109.98901, 22.94423, 0], [-109.98911, 22.94417, 0], [-109.9892, 22.9441, 0], [-109.98929, 22.94404, 0], [-109.98936, 22.944, 0], [-109.98946, 22.94395, 0], [-109.9896, 22.9439, 0], [-109.98977, 22.94383, 0], [-109.98978, 22.94382, 0], [-109.99013, 22.94374, 0], [-109.99055, 22.9437, 0], [-109.99064, 22.9437, 0], [-109.99074, 22.94371, 0], [-109.99085, 22.94371, 0], [-109.99122, 22.94376, 0], [-109.99141, 22.94382, 0], [-109.9918, 22.94396, 0], [-109.99205, 22.9441, 0], [-109.9922, 22.9442, 0], [-109.99236, 22.94432, 0], [-109.99257, 22.94452, 0], [-109.99298, 22.94497, 0], [-109.99374, 22.94586, 0], [-109.99394, 22.94613, 0], [-109.99435, 22.94661, 0], [-109.99468, 22.94704, 0], [-109.99476, 22.94713, 0], [-109.99556, 22.94813, 0], [-109.99558, 22.94815, 0], [-109.99573, 22.94833, 0], [-109.99593, 22.94854, 0], [-109.99602, 22.94865, 0], [-109.99652, 22.94917, 0], [-109.99734, 22.94996, 0], [-109.99802, 22.95068, 0], [-109.99938, 22.95207, 0], [-109.99985, 22.95251, 0], [-110.00065, 22.95331, 0], [-110.00077, 22.95342, 0], [-110.00836, 22.96117, 0], [-110.00985, 22.96263, 0], [-110.00992, 22.96271, 0], [-110.0137, 22.96641, 0], [-110.01373, 22.96643, 0], [-110.0148, 22.96748, 0], [-110.01505, 22.96774, 0], [-110.01507, 22.96775, 0], [-110.01683, 22.96948, 0], [-110.01756, 22.97016, 0], [-110.01796, 22.9705, 0], [-110.01835, 22.9708, 0], [-110.01837, 22.97081, 0], [-110.01871, 22.97104, 0], [-110.01903, 22.97122, 0], [-110.01957, 22.97149, 0], [-110.0199, 22.97162, 0], [-110.01991, 22.97163, 0], [-110.03278, 22.97614, 0], [-110.03296, 22.97621, 0], [-110.03479, 22.97684, 0], [-110.03516, 22.97698, 0], [-110.03537, 22.97704, 0], [-110.03812, 22.978, 0], [-110.03824, 22.97805, 0], [-110.0383, 22.97807, 0], [-110.03844, 22.97813, 0], [-110.03881, 22.97833, 0], [-110.03914, 22.97853, 0], [-110.03934, 22.97867, 0], [-110.03951, 22.9788, 0], [-110.03985, 22.97908, 0], [-110.04032, 22.97952, 0], [-110.04067, 22.97992, 0], [-110.04094, 22.98032, 0], [-110.04097, 22.98038, 0], [-110.04108, 22.98057, 0], [-110.04132, 22.98103, 0], [-110.04141, 22.98124, 0], [-110.0415, 22.98148, 0], [-110.04159, 22.98181, 0], [-110.0417, 22.98233, 0], [-110.04172, 22.98248, 0], [-110.04212, 22.98727, 0], [-110.04223, 22.98789, 0], [-110.04235, 22.98829, 0], [-110.04244, 22.98851, 0], [-110.04259, 22.98884, 0], [-110.04279, 22.98923, 0], [-110.04348, 22.99029, 0], [-110.0437, 22.9906, 0], [-110.04381, 22.99074, 0], [-110.04383, 22.99078, 0], [-110.04399, 22.99103, 0], [-110.044, 22.99106, 0], [-110.04417, 22.99136, 0], [-110.04417, 22.99138, 0], [-110.04422, 22.99149, 0], [-110.04424, 22.99155, 0], [-110.0443, 22.99168, 0], [-110.04442, 22.99203, 0], [-110.04447, 22.99223, 0], [-110.04457, 22.99282, 0], [-110.04459, 22.993, 0], [-110.04461, 22.99336, 0], [-110.0446, 22.99354, 0], [-110.0446, 22.99373, 0], [-110.04459, 22.99384, 0], [-110.04458, 22.9939, 0], [-110.04455, 22.9942, 0], [-110.04452, 22.99438, 0], [-110.04446, 22.99484, 0], [-110.04432, 22.99573, 0], [-110.04418, 22.99683, 0], [-110.04415, 22.99724, 0], [-110.04415, 22.99768, 0], [-110.04419, 22.99808, 0], [-110.04425, 22.9984, 0], [-110.04432, 22.99871, 0], [-110.04437, 22.99889, 0], [-110.0445, 22.99926, 0], [-110.04457, 22.99943, 0], [-110.04463, 22.99955, 0], [-110.04469, 22.9997, 0], [-110.04477, 22.99985, 0], [-110.04595, 23.00168, 0], [-110.04597, 23.0017, 0], [-110.04649, 23.00253, 0], [-110.04722, 23.00365, 0], [-110.04757, 23.00421, 0], [-110.04783, 23.00459, 0], [-110.04812, 23.00495, 0], [-110.04838, 23.00524, 0], [-110.04874, 23.00559, 0], [-110.04906, 23.00587, 0], [-110.04907, 23.00587, 0], [-110.04923, 23.006, 0], [-110.04955, 23.00621, 0], [-110.04957, 23.00622, 0], [-110.0497, 23.0063, 0], [-110.04971, 23.00631, 0], [-110.04987, 23.0064, 0], [-110.05008, 23.0065, 0], [-110.05029, 23.00661, 0], [-110.05122, 23.00701, 0], [-110.0522, 23.00739, 0], [-110.05527, 23.00851, 0], [-110.05589, 23.00878, 0], [-110.0559, 23.00879, 0], [-110.05623, 23.00896, 0], [-110.05624, 23.00896, 0], [-110.05659, 23.00915, 0], [-110.05674, 23.00925, 0], [-110.0569, 23.00934, 0], [-110.05691, 23.00935, 0], [-110.057, 23.0094, 0], [-110.05707, 23.00945, 0], [-110.05722, 23.00954, 0], [-110.05738, 23.00965, 0], [-110.05739, 23.00965, 0], [-110.05788, 23.00995, 0], [-110.05834, 23.01025, 0], [-110.05886, 23.01061, 0], [-110.05914, 23.01078, 0], [-110.06067, 23.01182, 0], [-110.07664, 23.02239, 0], [-110.07665, 23.0224, 0], [-110.07759, 23.02299, 0], [-110.07777, 23.02309, 0], [-110.07811, 23.02323, 0], [-110.07831, 23.0233, 0], [-110.07833, 23.0233, 0], [-110.07864, 23.02338, 0], [-110.07909, 23.02348, 0], [-110.07928, 23.02353, 0], [-110.0794, 23.02355, 0], [-110.07983, 23.02367, 0], [-110.08, 23.02373, 0], [-110.08017, 23.0238, 0], [-110.0802, 23.02382, 0], [-110.08031, 23.02388, 0], [-110.08059, 23.02409, 0], [-110.08071, 23.02421, 0], [-110.08081, 23.02432, 0], [-110.0809, 23.02443, 0], [-110.08099, 23.02458, 0], [-110.081, 23.02459, 0], [-110.08108, 23.02474, 0], [-110.08114, 23.02488, 0], [-110.08115, 23.02492, 0], [-110.08121, 23.02509, 0], [-110.08124, 23.02527, 0], [-110.08125, 23.0253, 0], [-110.08129, 23.0256, 0], [-110.08129, 23.02562, 0], [-110.08133, 23.02598, 0], [-110.08136, 23.02616, 0], [-110.08202, 23.03289, 0], [-110.08205, 23.03311, 0], [-110.08205, 23.03314, 0], [-110.08209, 23.03334, 0], [-110.08213, 23.03364, 0], [-110.08231, 23.03437, 0], [-110.08246, 23.03486, 0], [-110.08286, 23.03588, 0], [-110.08337, 23.03702, 0], [-110.08373, 23.03793, 0], [-110.08382, 23.0383, 0], [-110.08388, 23.03868, 0], [-110.08389, 23.03887, 0], [-110.08391, 23.03908, 0], [-110.08392, 23.03931, 0], [-110.08391, 23.03953, 0], [-110.08386, 23.03999, 0], [-110.08382, 23.04023, 0], [-110.08377, 23.04046, 0], [-110.08376, 23.04053, 0], [-110.08371, 23.04071, 0], [-110.08352, 23.04152, 0], [-110.08351, 23.04159, 0], [-110.08346, 23.04178, 0], [-110.0834, 23.04205, 0], [-110.08337, 23.04223, 0], [-110.08335, 23.04239, 0], [-110.08335, 23.04254, 0], [-110.08334, 23.04265, 0], [-110.08336, 23.04294, 0], [-110.08338, 23.0431, 0], [-110.0834, 23.04319, 0], [-110.08341, 23.04327, 0], [-110.08344, 23.04336, 0], [-110.08345, 23.04342, 0], [-110.08355, 23.04371, 0], [-110.08368, 23.04401, 0], [-110.08382, 23.04426, 0], [-110.0839, 23.04438, 0], [-110.0841, 23.04464, 0], [-110.0842, 23.04476, 0], [-110.08449, 23.04504, 0], [-110.08461, 23.04514, 0], [-110.08485, 23.04532, 0], [-110.08498, 23.04541, 0], [-110.08514, 23.0455, 0], [-110.08549, 23.04567, 0], [-110.08569, 23.04575, 0], [-110.08592, 23.04582, 0], [-110.08609, 23.04586, 0], [-110.08626, 23.04589, 0], [-110.08641, 23.0459, 0], [-110.08659, 23.04592, 0], [-110.08697, 23.04592, 0], [-110.08768, 23.04586, 0], [-110.08795, 23.04582, 0], [-110.08842, 23.04577, 0], [-110.08852, 23.04577, 0], [-110.08864, 23.04576, 0], [-110.0889, 23.04576, 0], [-110.08906, 23.04577, 0], [-110.08923, 23.04579, 0], [-110.08935, 23.04581, 0], [-110.08941, 23.04583, 0], [-110.08972, 23.04589, 0], [-110.09196, 23.04639, 0], [-110.09223, 23.04646, 0], [-110.09261, 23.04654, 0], [-110.09279, 23.04659, 0], [-110.09302, 23.04667, 0], [-110.09313, 23.04672, 0], [-110.09334, 23.04684, 0], [-110.0935, 23.04695, 0], [-110.09365, 23.04708, 0], [-110.09385, 23.0473, 0], [-110.09386, 23.04732, 0], [-110.09395, 23.04744, 0], [-110.0941, 23.04771, 0], [-110.09419, 23.04796, 0], [-110.09422, 23.04807, 0], [-110.09424, 23.04819, 0], [-110.09425, 23.04832, 0], [-110.09425, 23.04855, 0], [-110.09423, 23.0488, 0], [-110.09421, 23.04893, 0], [-110.0942, 23.04908, 0], [-110.09395, 23.05089, 0], [-110.09388, 23.05155, 0], [-110.09386, 23.05192, 0], [-110.09386, 23.05209, 0], [-110.09387, 23.05228, 0], [-110.09391, 23.05267, 0], [-110.09395, 23.05287, 0], [-110.09407, 23.0533, 0], [-110.09408, 23.05332, 0], [-110.09413, 23.05346, 0], [-110.09455, 23.05446, 0], [-110.09465, 23.05468, 0], [-110.09579, 23.05739, 0], [-110.09587, 23.05756, 0], [-110.09588, 23.05759, 0], [-110.09636, 23.05866, 0], [-110.09643, 23.05885, 0], [-110.09645, 23.05889, 0], [-110.09654, 23.05917, 0], [-110.09661, 23.0595, 0], [-110.09665, 23.05977, 0], [-110.09675, 23.06111, 0], [-110.09676, 23.06113, 0], [-110.09682, 23.0616, 0], [-110.09689, 23.062, 0], [-110.09699, 23.06237, 0], [-110.097, 23.06239, 0], [-110.09704, 23.06254, 0], [-110.09724, 23.06319, 0], [-110.09725, 23.06324, 0], [-110.09735, 23.06357, 0], [-110.09735, 23.06358, 0], [-110.09745, 23.06393, 0], [-110.09745, 23.06394, 0], [-110.09759, 23.06437, 0], [-110.09762, 23.06445, 0], [-110.09772, 23.0648, 0], [-110.09778, 23.06497, 0], [-110.09788, 23.06532, 0], [-110.09794, 23.06549, 0], [-110.09894, 23.06869, 0], [-110.09928, 23.06973, 0], [-110.09931, 23.06981, 0], [-110.0996, 23.07077, 0], [-110.09961, 23.07079, 0], [-110.09965, 23.07094, 0], [-110.09994, 23.0718, 0], [-110.09999, 23.07197, 0], [-110.10015, 23.07244, 0], [-110.10024, 23.07268, 0], [-110.10032, 23.07287, 0], [-110.10049, 23.07321, 0], [-110.10056, 23.07333, 0], [-110.10065, 23.07347, 0], [-110.10095, 23.07388, 0], [-110.10107, 23.07402, 0], [-110.10188, 23.07486, 0], [-110.10219, 23.07521, 0], [-110.10238, 23.07545, 0], [-110.10253, 23.07566, 0], [-110.10257, 23.07573, 0], [-110.10268, 23.07588, 0], [-110.10294, 23.07637, 0], [-110.103, 23.07653, 0], [-110.10301, 23.07655, 0], [-110.10309, 23.07681, 0], [-110.10315, 23.07706, 0], [-110.10315, 23.07707, 0], [-110.10318, 23.07723, 0], [-110.10322, 23.07759, 0], [-110.10322, 23.07775, 0], [-110.10323, 23.07792, 0], [-110.10321, 23.07835, 0], [-110.10309, 23.07953, 0], [-110.10195, 23.08847, 0], [-110.10186, 23.08932, 0], [-110.10185, 23.08954, 0], [-110.10185, 23.09033, 0], [-110.10188, 23.0908, 0], [-110.10192, 23.09116, 0], [-110.10192, 23.09118, 0], [-110.10199, 23.09171, 0], [-110.10203, 23.09187, 0], [-110.10206, 23.09205, 0], [-110.10215, 23.09244, 0], [-110.10223, 23.09273, 0], [-110.10311, 23.09538, 0], [-110.10316, 23.09555, 0], [-110.10363, 23.09693, 0], [-110.10368, 23.0971, 0], [-110.1046, 23.09987, 0], [-110.10484, 23.10066, 0], [-110.10507, 23.10153, 0], [-110.10523, 23.10232, 0], [-110.10539, 23.10335, 0], [-110.1056, 23.10511, 0], [-110.10569, 23.10601, 0], [-110.1057, 23.10619, 0], [-110.10578, 23.10691, 0], [-110.10578, 23.10709, 0], [-110.10579, 23.10721, 0], [-110.1058, 23.10751, 0], [-110.10578, 23.10812, 0], [-110.10576, 23.10842, 0], [-110.10568, 23.10907, 0], [-110.10562, 23.1094, 0], [-110.10551, 23.1099, 0], [-110.10541, 23.1103, 0], [-110.10494, 23.11186, 0], [-110.10481, 23.11222, 0], [-110.10435, 23.11368, 0], [-110.10429, 23.11385, 0], [-110.10424, 23.11402, 0], [-110.10418, 23.11419, 0], [-110.10405, 23.11464, 0], [-110.10402, 23.11471, 0], [-110.10394, 23.11498, 0], [-110.10389, 23.11524, 0], [-110.10387, 23.1153, 0], [-110.10386, 23.11542, 0], [-110.10385, 23.11544, 0], [-110.10383, 23.11578, 0], [-110.10383, 23.11607, 0], [-110.10384, 23.11625, 0], [-110.10389, 23.11657, 0], [-110.10401, 23.11705, 0], [-110.10413, 23.11737, 0], [-110.1042, 23.11752, 0], [-110.10439, 23.11784, 0], [-110.10451, 23.11799, 0], [-110.10453, 23.11802, 0], [-110.10468, 23.11819, 0], [-110.10483, 23.11834, 0], [-110.10509, 23.11855, 0], [-110.10523, 23.11864, 0], [-110.10537, 23.11874, 0], [-110.10593, 23.11902, 0], [-110.10612, 23.1191, 0], [-110.10613, 23.11911, 0], [-110.10648, 23.11923, 0], [-110.10695, 23.11934, 0], [-110.1088, 23.11963, 0], [-110.10883, 23.11964, 0], [-110.10899, 23.11966, 0], [-110.11141, 23.12005, 0], [-110.11246, 23.12024, 0], [-110.11282, 23.12032, 0], [-110.11284, 23.12032, 0], [-110.11303, 23.12037, 0], [-110.11317, 23.1204, 0], [-110.11376, 23.12059, 0], [-110.11395, 23.12066, 0], [-110.11399, 23.12067, 0], [-110.11413, 23.12073, 0], [-110.11423, 23.12078, 0], [-110.11446, 23.12088, 0], [-110.11462, 23.12096, 0], [-110.1148, 23.12107, 0], [-110.11482, 23.12108, 0], [-110.11514, 23.12128, 0], [-110.11524, 23.12135, 0], [-110.11559, 23.12164, 0], [-110.11584, 23.12186, 0], [-110.11613, 23.12214, 0], [-110.11643, 23.12246, 0], [-110.11787, 23.12418, 0], [-110.11812, 23.12453, 0], [-110.11837, 23.12491, 0], [-110.11854, 23.12525, 0], [-110.11868, 23.12559, 0], [-110.11873, 23.12574, 0], [-110.11881, 23.12609, 0], [-110.11883, 23.12621, 0], [-110.11886, 23.12661, 0], [-110.11885, 23.12665, 0], [-110.11885, 23.12692, 0], [-110.11883, 23.12717, 0], [-110.11878, 23.12759, 0], [-110.11826, 23.13026, 0], [-110.1182, 23.13061, 0], [-110.11814, 23.13106, 0], [-110.11814, 23.13109, 0], [-110.1181, 23.13158, 0], [-110.11808, 23.13208, 0], [-110.11809, 23.13276, 0], [-110.11815, 23.13391, 0], [-110.11817, 23.13409, 0], [-110.11826, 23.13571, 0], [-110.11839, 23.13744, 0], [-110.1185, 23.13853, 0], [-110.11856, 23.13902, 0], [-110.11944, 23.14432, 0], [-110.11946, 23.14448, 0], [-110.11953, 23.14484, 0], [-110.1197, 23.14556, 0], [-110.11977, 23.1458, 0], [-110.11998, 23.1464, 0], [-110.12049, 23.14772, 0], [-110.12368, 23.15558, 0], [-110.12369, 23.15563, 0], [-110.12394, 23.15637, 0], [-110.12408, 23.15684, 0], [-110.12412, 23.15694, 0], [-110.12431, 23.15767, 0], [-110.12444, 23.15822, 0], [-110.1248, 23.15997, 0], [-110.12579, 23.16556, 0], [-110.12591, 23.16613, 0], [-110.12591, 23.16614, 0], [-110.12602, 23.16657, 0], [-110.12607, 23.1667, 0], [-110.12612, 23.16685, 0], [-110.12635, 23.1674, 0], [-110.12655, 23.16779, 0], [-110.12677, 23.16814, 0], [-110.12678, 23.16815, 0], [-110.1269, 23.16832, 0], [-110.12724, 23.16875, 0], [-110.1283, 23.16994, 0], [-110.12834, 23.16998, 0], [-110.12846, 23.17012, 0], [-110.12859, 23.17025, 0], [-110.12984, 23.17163, 0], [-110.12988, 23.17168, 0], [-110.12997, 23.17177, 0], [-110.13578, 23.17821, 0], [-110.13602, 23.1785, 0], [-110.13629, 23.17891, 0], [-110.13647, 23.1792, 0], [-110.13663, 23.17951, 0], [-110.13664, 23.17952, 0], [-110.13676, 23.17981, 0], [-110.13678, 23.17984, 0], [-110.13684, 23.18001, 0], [-110.13684, 23.18002, 0], [-110.13691, 23.18024, 0], [-110.13698, 23.18053, 0], [-110.13699, 23.18055, 0], [-110.13704, 23.18079, 0], [-110.13711, 23.18132, 0], [-110.13715, 23.18173, 0], [-110.13715, 23.18178, 0], [-110.13738, 23.18601, 0], [-110.13755, 23.18997, 0], [-110.13773, 23.19313, 0], [-110.13808, 23.20077, 0], [-110.13816, 23.20207, 0], [-110.13823, 23.20277, 0], [-110.1383, 23.2033, 0], [-110.13842, 23.20404, 0], [-110.13851, 23.20445, 0], [-110.13854, 23.20463, 0], [-110.13855, 23.20466, 0], [-110.13874, 23.20545, 0], [-110.13875, 23.20551, 0], [-110.14031, 23.21108, 0], [-110.1405, 23.21182, 0], [-110.14115, 23.21405, 0], [-110.14115, 23.21406, 0], [-110.14417, 23.22477, 0], [-110.14429, 23.22514, 0], [-110.14444, 23.22551, 0], [-110.1446, 23.22582, 0], [-110.14476, 23.22609, 0], [-110.14487, 23.22624, 0], [-110.14535, 23.22694, 0], [-110.14558, 23.22733, 0], [-110.14566, 23.2275, 0], [-110.14566, 23.22751, 0], [-110.14578, 23.2278, 0], [-110.14589, 23.22823, 0], [-110.14677, 23.23247, 0], [-110.14681, 23.23261, 0], [-110.14682, 23.23263, 0], [-110.14686, 23.23279, 0], [-110.14688, 23.23285, 0], [-110.14693, 23.23304, 0], [-110.14711, 23.23351, 0], [-110.14731, 23.23397, 0], [-110.14757, 23.23446, 0], [-110.14777, 23.2348, 0], [-110.14805, 23.23522, 0], [-110.14817, 23.23538, 0], [-110.14873, 23.23608, 0], [-110.14923, 23.23667, 0], [-110.14948, 23.237, 0], [-110.14976, 23.23741, 0], [-110.15002, 23.23783, 0], [-110.1501, 23.23798, 0], [-110.15011, 23.23799, 0], [-110.15019, 23.23815, 0], [-110.1502, 23.23816, 0], [-110.15027, 23.23832, 0], [-110.15032, 23.2384, 0], [-110.15042, 23.23865, 0], [-110.15044, 23.23869, 0], [-110.15056, 23.239, 0], [-110.15071, 23.23945, 0], [-110.15075, 23.2396, 0], [-110.1508, 23.23976, 0], [-110.15087, 23.24005, 0], [-110.1509, 23.2402, 0], [-110.1509, 23.24021, 0], [-110.15093, 23.24034, 0], [-110.15093, 23.24038, 0], [-110.15095, 23.2405, 0], [-110.15102, 23.24105, 0], [-110.15102, 23.2411, 0], [-110.15114, 23.24235, 0], [-110.15115, 23.24253, 0], [-110.15141, 23.24522, 0], [-110.15141, 23.24547, 0], [-110.15148, 23.24615, 0], [-110.15152, 23.24665, 0], [-110.15166, 23.248, 0], [-110.15166, 23.24812, 0], [-110.15167, 23.24827, 0], [-110.15167, 23.24863, 0], [-110.15166, 23.24882, 0], [-110.15155, 23.24963, 0], [-110.1515, 23.24987, 0], [-110.15141, 23.2502, 0], [-110.1512, 23.25083, 0], [-110.15097, 23.25133, 0], [-110.15066, 23.25189, 0], [-110.15047, 23.25218, 0], [-110.15027, 23.25246, 0], [-110.14968, 23.25324, 0], [-110.14945, 23.25358, 0], [-110.14927, 23.25383, 0], [-110.149, 23.2543, 0], [-110.14889, 23.25452, 0], [-110.14887, 23.25462, 0], [-110.14875, 23.25491, 0], [-110.14869, 23.25504, 0], [-110.14857, 23.25541, 0], [-110.14842, 23.256, 0], [-110.14834, 23.25668, 0], [-110.14834, 23.2574, 0], [-110.14839, 23.2578, 0], [-110.14857, 23.25884, 0], [-110.14865, 23.25919, 0], [-110.14868, 23.2593, 0], [-110.14895, 23.26074, 0], [-110.14902, 23.26129, 0], [-110.14909, 23.26201, 0], [-110.14909, 23.26207, 0], [-110.14912, 23.26255, 0], [-110.14921, 23.2649, 0], [-110.14921, 23.26506, 0], [-110.14925, 23.26614, 0], [-110.14926, 23.26674, 0], [-110.14952, 23.2705, 0], [-110.14954, 23.27068, 0], [-110.14998, 23.27692, 0], [-110.15012, 23.27774, 0], [-110.1502, 23.27812, 0], [-110.15038, 23.27877, 0], [-110.15351, 23.28938, 0], [-110.15351, 23.2894, 0], [-110.15402, 23.29112, 0], [-110.15403, 23.29114, 0], [-110.15458, 23.29303, 0], [-110.15459, 23.29305, 0], [-110.15636, 23.29909, 0], [-110.15638, 23.29914, 0], [-110.15679, 23.30052, 0], [-110.15682, 23.30065, 0], [-110.15857, 23.30657, 0], [-110.15857, 23.30659, 0], [-110.16014, 23.31197, 0], [-110.16056, 23.31334, 0], [-110.16065, 23.31372, 0], [-110.16065, 23.31374, 0], [-110.16068, 23.31392, 0], [-110.16073, 23.3143, 0], [-110.16075, 23.3146, 0], [-110.16079, 23.316, 0], [-110.1608, 23.31606, 0], [-110.1608, 23.31624, 0], [-110.16093, 23.31948, 0], [-110.16094, 23.31997, 0], [-110.16095, 23.32002, 0], [-110.16112, 23.32546, 0], [-110.16113, 23.32555, 0], [-110.16149, 23.33578, 0], [-110.16151, 23.33718, 0], [-110.16148, 23.33758, 0], [-110.16131, 23.33867, 0], [-110.16086, 23.34131, 0], [-110.16078, 23.342, 0], [-110.16077, 23.34203, 0], [-110.16076, 23.34219, 0], [-110.16076, 23.34234, 0], [-110.16075, 23.34239, 0], [-110.16075, 23.34249, 0], [-110.16078, 23.34306, 0], [-110.1608, 23.34322, 0], [-110.16084, 23.34343, 0], [-110.16089, 23.34375, 0], [-110.16165, 23.34767, 0], [-110.16169, 23.34782, 0], [-110.16171, 23.34796, 0], [-110.16215, 23.35032, 0], [-110.16217, 23.35039, 0], [-110.16228, 23.35099, 0], [-110.16231, 23.35109, 0], [-110.16233, 23.3512, 0], [-110.16248, 23.35169, 0], [-110.16254, 23.35185, 0], [-110.16262, 23.35203, 0], [-110.16274, 23.35227, 0], [-110.16286, 23.35249, 0], [-110.1631, 23.35287, 0], [-110.16322, 23.35304, 0], [-110.16324, 23.35306, 0], [-110.16331, 23.35315, 0], [-110.16371, 23.3536, 0], [-110.16387, 23.35375, 0], [-110.16406, 23.35391, 0], [-110.16431, 23.3541, 0], [-110.16463, 23.35432, 0], [-110.16941, 23.35719, 0], [-110.17041, 23.35777, 0], [-110.17087, 23.35807, 0], [-110.17101, 23.35817, 0], [-110.17104, 23.3582, 0], [-110.17126, 23.35838, 0], [-110.17134, 23.35846, 0], [-110.17138, 23.35851, 0], [-110.17151, 23.35864, 0], [-110.17171, 23.35889, 0], [-110.17183, 23.35908, 0], [-110.17195, 23.3593, 0], [-110.17205, 23.35952, 0], [-110.17213, 23.35972, 0], [-110.17221, 23.35997, 0], [-110.17229, 23.36033, 0], [-110.17274, 23.36415, 0], [-110.1728, 23.36447, 0], [-110.17282, 23.36461, 0], [-110.17286, 23.36475, 0], [-110.17303, 23.36521, 0], [-110.17309, 23.36534, 0], [-110.17314, 23.36548, 0], [-110.17319, 23.36558, 0], [-110.17325, 23.36568, 0], [-110.17328, 23.36574, 0], [-110.17339, 23.36593, 0], [-110.17345, 23.36605, 0], [-110.17425, 23.36749, 0], [-110.17426, 23.3675, 0], [-110.17452, 23.36803, 0], [-110.1747, 23.36848, 0], [-110.17539, 23.37035, 0], [-110.17543, 23.37048, 0], [-110.17564, 23.37096, 0], [-110.17576, 23.37118, 0], [-110.17597, 23.3715, 0], [-110.17614, 23.37173, 0], [-110.17869, 23.37488, 0], [-110.17898, 23.37527, 0], [-110.17921, 23.37564, 0], [-110.18391, 23.38375, 0], [-110.18393, 23.38379, 0], [-110.1843, 23.38441, 0], [-110.18513, 23.38586, 0], [-110.1853, 23.38614, 0], [-110.18618, 23.38767, 0], [-110.18633, 23.38795, 0], [-110.18664, 23.38847, 0], [-110.18666, 23.38851, 0], [-110.18673, 23.38863, 0], [-110.18676, 23.38869, 0], [-110.18715, 23.38934, 0], [-110.18719, 23.38942, 0], [-110.18785, 23.39051, 0], [-110.18786, 23.39052, 0], [-110.18789, 23.39057, 0], [-110.18809, 23.39086, 0], [-110.18821, 23.39101, 0], [-110.19422, 23.39806, 0], [-110.19505, 23.39907, 0], [-110.19532, 23.39936, 0], [-110.19615, 23.40033, 0], [-110.1964, 23.40064, 0], [-110.19685, 23.40114, 0], [-110.1985, 23.40274, 0], [-110.20107, 23.40529, 0], [-110.20138, 23.40561, 0], [-110.20172, 23.40598, 0], [-110.202, 23.40639, 0], [-110.20214, 23.40662, 0], [-110.20379, 23.40998, 0], [-110.20449, 23.41135, 0], [-110.20494, 23.41218, 0], [-110.20516, 23.41255, 0], [-110.2062, 23.41444, 0], [-110.20628, 23.41461, 0], [-110.20632, 23.41481, 0], [-110.20636, 23.41524, 0], [-110.20628, 23.416, 0], [-110.20633, 23.41879, 0], [-110.2061, 23.42552, 0], [-110.20609, 23.42561, 0], [-110.20604, 23.42672, 0], [-110.20599, 23.42723, 0], [-110.20589, 23.42795, 0], [-110.20573, 23.42877, 0], [-110.20557, 23.42948, 0], [-110.20535, 23.43025, 0], [-110.20498, 23.43146, 0], [-110.20492, 23.43163, 0], [-110.20393, 23.43481, 0], [-110.20375, 23.43544, 0], [-110.20356, 23.43624, 0], [-110.20333, 23.43742, 0], [-110.20316, 23.43876, 0], [-110.20314, 23.43917, 0], [-110.20314, 23.43935, 0], [-110.20312, 23.4399, 0], [-110.20312, 23.44058, 0], [-110.2032, 23.4424, 0], [-110.20322, 23.44258, 0], [-110.20352, 23.44653, 0], [-110.20354, 23.44671, 0], [-110.20408, 23.45325, 0], [-110.20417, 23.45391, 0], [-110.20429, 23.45459, 0], [-110.20442, 23.45521, 0], [-110.20458, 23.45581, 0], [-110.20475, 23.45633, 0], [-110.20506, 23.45714, 0], [-110.20534, 23.45775, 0], [-110.20548, 23.458, 0], [-110.20556, 23.45817, 0], [-110.20751, 23.46172, 0], [-110.20931, 23.46489, 0], [-110.21041, 23.46694, 0], [-110.21043, 23.46699, 0], [-110.21067, 23.46748, 0], [-110.21093, 23.46808, 0], [-110.21114, 23.46867, 0], [-110.2113, 23.46919, 0], [-110.21131, 23.46921, 0], [-110.2114, 23.46953, 0], [-110.21157, 23.47024, 0], [-110.21163, 23.47059, 0], [-110.21163, 23.47062, 0], [-110.2117, 23.47105, 0], [-110.21181, 23.47198, 0], [-110.21182, 23.47202, 0], [-110.21183, 23.4722, 0], [-110.2124, 23.47858, 0], [-110.21238, 23.47865, 0], [-110.21239, 23.47875, 0], [-110.21241, 23.47918, 0], [-110.21244, 23.47945, 0], [-110.21248, 23.47997, 0], [-110.21249, 23.48022, 0], [-110.21251, 23.48049, 0], [-110.21251, 23.48106, 0], [-110.21246, 23.48188, 0], [-110.2124, 23.48225, 0], [-110.21232, 23.48261, 0], [-110.21219, 23.48307, 0], [-110.21205, 23.48348, 0], [-110.21198, 23.48366, 0], [-110.21173, 23.48421, 0], [-110.2117, 23.48426, 0], [-110.21081, 23.48597, 0], [-110.21069, 23.48614, 0], [-110.20832, 23.49071, 0], [-110.20653, 23.49423, 0], [-110.20651, 23.49428, 0], [-110.20497, 23.49732, 0], [-110.20285, 23.50208, 0], [-110.19585, 23.51834, 0], [-110.19562, 23.51893, 0], [-110.1955, 23.51946, 0], [-110.19549, 23.51962, 0], [-110.19547, 23.51972, 0], [-110.19547, 23.5198, 0], [-110.19545, 23.51995, 0], [-110.19544, 23.52014, 0], [-110.19544, 23.52051, 0], [-110.19548, 23.5209, 0], [-110.19555, 23.52134, 0], [-110.19558, 23.52148, 0], [-110.19575, 23.52202, 0], [-110.19866, 23.52939, 0], [-110.19873, 23.52955, 0], [-110.19901, 23.53027, 0], [-110.19902, 23.53029, 0], [-110.19916, 23.53065, 0], [-110.19936, 23.53126, 0], [-110.19949, 23.53183, 0], [-110.1995, 23.53186, 0], [-110.19953, 23.532, 0], [-110.19955, 23.53214, 0], [-110.19957, 23.5322, 0], [-110.19966, 23.53282, 0], [-110.19972, 23.53353, 0], [-110.19973, 23.5338, 0], [-110.19972, 23.53422, 0], [-110.19969, 23.53469, 0], [-110.19962, 23.53533, 0], [-110.19955, 23.53575, 0], [-110.19946, 23.53617, 0], [-110.19922, 23.53699, 0], [-110.19907, 23.5374, 0], [-110.19884, 23.53793, 0], [-110.19864, 23.53832, 0], [-110.19859, 23.53843, 0], [-110.19837, 23.5388, 0], [-110.19303, 23.54739, 0], [-110.19294, 23.54755, 0], [-110.19284, 23.54771, 0], [-110.19282, 23.54773, 0], [-110.19258, 23.54813, 0], [-110.19245, 23.54833, 0], [-110.19207, 23.54896, 0], [-110.19199, 23.54911, 0], [-110.19177, 23.54949, 0], [-110.19164, 23.54977, 0], [-110.19153, 23.55003, 0], [-110.19141, 23.55035, 0], [-110.19129, 23.55077, 0], [-110.19126, 23.55091, 0], [-110.19124, 23.55097, 0], [-110.19123, 23.55106, 0], [-110.1912, 23.5512, 0], [-110.19116, 23.55149, 0], [-110.19114, 23.55176, 0], [-110.19113, 23.55201, 0], [-110.19114, 23.55219, 0], [-110.19115, 23.55227, 0], [-110.19115, 23.5524, 0], [-110.19122, 23.55289, 0], [-110.19123, 23.55294, 0], [-110.19127, 23.55307, 0], [-110.19132, 23.55327, 0], [-110.19132, 23.55329, 0], [-110.19148, 23.55374, 0], [-110.1916, 23.55401, 0], [-110.19174, 23.5543, 0], [-110.19182, 23.55445, 0], [-110.19198, 23.55471, 0], [-110.19223, 23.55507, 0], [-110.19245, 23.55534, 0], [-110.19266, 23.55557, 0], [-110.19289, 23.55579, 0], [-110.19311, 23.55598, 0], [-110.19351, 23.55628, 0], [-110.19366, 23.55638, 0], [-110.19396, 23.55656, 0], [-110.1943, 23.55674, 0], [-110.1946, 23.55688, 0], [-110.19485, 23.55698, 0], [-110.19517, 23.55709, 0], [-110.19549, 23.55718, 0], [-110.19571, 23.55723, 0], [-110.19581, 23.55726, 0], [-110.19597, 23.55729, 0], [-110.19919, 23.5577, 0], [-110.19966, 23.55777, 0], [-110.19994, 23.55783, 0], [-110.20001, 23.55784, 0], [-110.20011, 23.55787, 0], [-110.20013, 23.55787, 0], [-110.20024, 23.55791, 0], [-110.20047, 23.55798, 0], [-110.2009, 23.55817, 0], [-110.20104, 23.55825, 0], [-110.20129, 23.55841, 0], [-110.20141, 23.5585, 0], [-110.20189, 23.5589, 0], [-110.20245, 23.5594, 0], [-110.20279, 23.55966, 0], [-110.20295, 23.55977, 0], [-110.20297, 23.55978, 0], [-110.20318, 23.55991, 0], [-110.20327, 23.55995, 0], [-110.20338, 23.56001, 0], [-110.20413, 23.56028, 0], [-110.2057, 23.56072, 0], [-110.20596, 23.56081, 0], [-110.2063, 23.56094, 0], [-110.20669, 23.56114, 0], [-110.20691, 23.56127, 0], [-110.20691, 23.56128, 0], [-110.20695, 23.5613, 0], [-110.20707, 23.56139, 0], [-110.20721, 23.56151, 0], [-110.20742, 23.56172, 0], [-110.20761, 23.56195, 0], [-110.20769, 23.56207, 0], [-110.20777, 23.56221, 0], [-110.20795, 23.56256, 0], [-110.20803, 23.56274, 0], [-110.2087, 23.56441, 0], [-110.20892, 23.56502, 0], [-110.20908, 23.56543, 0], [-110.20916, 23.56566, 0], [-110.20921, 23.56575, 0], [-110.20924, 23.56582, 0], [-110.20938, 23.5661, 0], [-110.20947, 23.56626, 0], [-110.20952, 23.56636, 0], [-110.20967, 23.5666, 0], [-110.20993, 23.56705, 0], [-110.20997, 23.56711, 0], [-110.21017, 23.56749, 0], [-110.2102, 23.56753, 0], [-110.21072, 23.56846, 0], [-110.21093, 23.56881, 0], [-110.21156, 23.56992, 0], [-110.21156, 23.56993, 0], [-110.2121, 23.57088, 0], [-110.2121, 23.5709, 0], [-110.21222, 23.57114, 0], [-110.21229, 23.5713, 0], [-110.21249, 23.57185, 0], [-110.21256, 23.57212, 0], [-110.21266, 23.57257, 0], [-110.21331, 23.57638, 0], [-110.2134, 23.57672, 0], [-110.21342, 23.57677, 0], [-110.21347, 23.57697, 0], [-110.21356, 23.57721, 0], [-110.21356, 23.57723, 0], [-110.21363, 23.5774, 0], [-110.21366, 23.5775, 0], [-110.21385, 23.57789, 0], [-110.214, 23.57816, 0], [-110.21412, 23.57836, 0], [-110.21428, 23.57859, 0], [-110.2144, 23.57875, 0], [-110.21453, 23.57891, 0], [-110.21453, 23.57892, 0], [-110.21538, 23.57999, 0], [-110.21541, 23.58002, 0], [-110.21573, 23.58042, 0], [-110.21584, 23.58057, 0], [-110.21585, 23.58057, 0], [-110.21606, 23.58084, 0], [-110.21703, 23.582, 0], [-110.21708, 23.58207, 0], [-110.2176, 23.58273, 0], [-110.21823, 23.58358, 0], [-110.21827, 23.58362, 0], [-110.21845, 23.58386, 0], [-110.21885, 23.58431, 0], [-110.21898, 23.58448, 0], [-110.21899, 23.58448, 0], [-110.21915, 23.58467, 0], [-110.21944, 23.58506, 0], [-110.21945, 23.58506, 0], [-110.21945, 23.58507, 0], [-110.21977, 23.58547, 0], [-110.21979, 23.58549, 0], [-110.21979, 23.5855, 0], [-110.22019, 23.58599, 0], [-110.2205, 23.58639, 0], [-110.2206, 23.58651, 0], [-110.22062, 23.58654, 0], [-110.22106, 23.58709, 0], [-110.2218, 23.58806, 0], [-110.22235, 23.58865, 0], [-110.22259, 23.58888, 0], [-110.22278, 23.58908, 0], [-110.22305, 23.58933, 0], [-110.22357, 23.58978, 0], [-110.22419, 23.59029, 0], [-110.22435, 23.59045, 0], [-110.22447, 23.59058, 0], [-110.22467, 23.59078, 0], [-110.22496, 23.59114, 0], [-110.22516, 23.59142, 0], [-110.22532, 23.59169, 0], [-110.22553, 23.59211, 0], [-110.22581, 23.59281, 0], [-110.22589, 23.59299, 0], [-110.22599, 23.59326, 0], [-110.22639, 23.59422, 0], [-110.22993, 23.60304, 0], [-110.23004, 23.60337, 0], [-110.23023, 23.60413, 0], [-110.23048, 23.60505, 0], [-110.23059, 23.60551, 0], [-110.2306, 23.60557, 0], [-110.23068, 23.60593, 0], [-110.2308, 23.60638, 0], [-110.23089, 23.60683, 0], [-110.23092, 23.60695, 0], [-110.23094, 23.60709, 0], [-110.23097, 23.60745, 0], [-110.23098, 23.60777, 0], [-110.23097, 23.60795, 0], [-110.23098, 23.6088, 0], [-110.23097, 23.60915, 0], [-110.23097, 23.6133, 0], [-110.23089, 23.62093, 0], [-110.23085, 23.62192, 0], [-110.2308, 23.62238, 0], [-110.23067, 23.62317, 0], [-110.22983, 23.62732, 0], [-110.22966, 23.62823, 0], [-110.22881, 23.63242, 0], [-110.22877, 23.63259, 0], [-110.22772, 23.63779, 0], [-110.22769, 23.63797, 0], [-110.22675, 23.64275, 0], [-110.22671, 23.64292, 0], [-110.22259, 23.66322, 0], [-110.22245, 23.66409, 0], [-110.2224, 23.66449, 0], [-110.22239, 23.66471, 0], [-110.22237, 23.66493, 0], [-110.22238, 23.66605, 0], [-110.22245, 23.66673, 0], [-110.22258, 23.66762, 0], [-110.22346, 23.67475, 0], [-110.22351, 23.67508, 0], [-110.22353, 23.67526, 0], [-110.22359, 23.67566, 0], [-110.22396, 23.67889, 0], [-110.22396, 23.67891, 0], [-110.22402, 23.67932, 0], [-110.22409, 23.68012, 0], [-110.22411, 23.6807, 0], [-110.22411, 23.68113, 0], [-110.22412, 23.68142, 0], [-110.22412, 23.68178, 0], [-110.22417, 23.68251, 0], [-110.22421, 23.68283, 0], [-110.22433, 23.68356, 0], [-110.22441, 23.6839, 0], [-110.2246, 23.68458, 0], [-110.22478, 23.68515, 0], [-110.22494, 23.6857, 0], [-110.22505, 23.68602, 0], [-110.22522, 23.68656, 0], [-110.22535, 23.68701, 0], [-110.22613, 23.68952, 0], [-110.22625, 23.68999, 0], [-110.22758, 23.69839, 0], [-110.22817, 23.70184, 0], [-110.23317, 23.73276, 0], [-110.23708, 23.75797, 0], [-110.2371, 23.75815, 0], [-110.24078, 23.78186, 0], [-110.2408, 23.78204, 0], [-110.24416, 23.8039, 0], [-110.24417, 23.80401, 0], [-110.24603, 23.81625, 0], [-110.2461, 23.81678, 0], [-110.24751, 23.82596, 0], [-110.24753, 23.82614, 0], [-110.24795, 23.82881, 0], [-110.24795, 23.82886, 0], [-110.2487, 23.83362, 0], [-110.24884, 23.83463, 0], [-110.25052, 23.84562, 0], [-110.25059, 23.84602, 0], [-110.2506, 23.84612, 0], [-110.25111, 23.8494, 0], [-110.25115, 23.84971, 0], [-110.25375, 23.86657, 0], [-110.25377, 23.86674, 0], [-110.25488, 23.87411, 0], [-110.25491, 23.87436, 0], [-110.25493, 23.87475, 0], [-110.25492, 23.87534, 0], [-110.25489, 23.87568, 0], [-110.25484, 23.87606, 0], [-110.25472, 23.87668, 0], [-110.25466, 23.87692, 0], [-110.2533, 23.88169, 0], [-110.25324, 23.88188, 0], [-110.25286, 23.88325, 0], [-110.2528, 23.88354, 0], [-110.25277, 23.88375, 0], [-110.25276, 23.88394, 0], [-110.25278, 23.88414, 0], [-110.25282, 23.88423, 0], [-110.25286, 23.88437, 0], [-110.25289, 23.88445, 0], [-110.25305, 23.88471, 0], [-110.25313, 23.88481, 0], [-110.25333, 23.88499, 0], [-110.25345, 23.88508, 0], [-110.2536, 23.88516, 0], [-110.2539, 23.88527, 0], [-110.25409, 23.88531, 0], [-110.25446, 23.88537, 0], [-110.25471, 23.88542, 0], [-110.25494, 23.88545, 0], [-110.25523, 23.88551, 0], [-110.25544, 23.88559, 0], [-110.25563, 23.88568, 0], [-110.25578, 23.88577, 0], [-110.25602, 23.88598, 0], [-110.25617, 23.88615, 0], [-110.25625, 23.88626, 0], [-110.25632, 23.88637, 0], [-110.25639, 23.8865, 0], [-110.25648, 23.88678, 0], [-110.2565, 23.88687, 0], [-110.25661, 23.88711, 0], [-110.257, 23.88973, 0], [-110.25702, 23.88991, 0], [-110.25995, 23.90887, 0], [-110.26004, 23.90963, 0], [-110.26024, 23.91082, 0], [-110.26143, 23.91845, 0], [-110.26163, 23.91958, 0], [-110.26164, 23.91968, 0], [-110.26173, 23.92002, 0], [-110.26177, 23.92021, 0], [-110.26184, 23.92047, 0], [-110.26198, 23.92091, 0], [-110.26213, 23.92132, 0], [-110.26254, 23.92222, 0], [-110.26495, 23.92715, 0], [-110.26536, 23.92796, 0], [-110.26631, 23.92996, 0], [-110.26699, 23.93134, 0], [-110.2674, 23.93207, 0], [-110.26757, 23.93235, 0], [-110.26775, 23.9326, 0], [-110.26784, 23.93269, 0], [-110.26793, 23.9328, 0], [-110.26816, 23.93304, 0], [-110.26918, 23.93392, 0], [-110.26938, 23.93407, 0], [-110.27057, 23.93508, 0], [-110.2719, 23.93617, 0], [-110.27599, 23.93962, 0], [-110.27631, 23.93991, 0], [-110.27648, 23.94008, 0], [-110.27665, 23.94027, 0], [-110.27686, 23.94055, 0], [-110.27701, 23.94079, 0], [-110.27724, 23.94124, 0], [-110.27735, 23.9415, 0], [-110.2794, 23.94766, 0], [-110.27957, 23.94821, 0], [-110.27966, 23.94858, 0], [-110.28171, 23.95834, 0], [-110.28213, 23.96024, 0], [-110.28216, 23.96042, 0], [-110.28404, 23.96915, 0], [-110.28458, 23.9718, 0], [-110.28512, 23.97413, 0], [-110.28546, 23.97578, 0], [-110.28575, 23.97702, 0], [-110.2872, 23.98403, 0], [-110.28802, 23.9877, 0], [-110.29065, 23.99999, 0], [-110.29136, 24.00316, 0], [-110.29209, 24.0066, 0], [-110.29286, 24.01, 0], [-110.29304, 24.01091, 0], [-110.29401, 24.01521, 0], [-110.29428, 24.0165, 0], [-110.29436, 24.01693, 0], [-110.29459, 24.01802, 0], [-110.29498, 24.01971, 0], [-110.29727, 24.03015, 0], [-110.29734, 24.03055, 0], [-110.29881, 24.03727, 0], [-110.2989, 24.03763, 0], [-110.29947, 24.04019, 0], [-110.29953, 24.04056, 0], [-110.3015, 24.04944, 0], [-110.30158, 24.04989, 0], [-110.30241, 24.0535, 0], [-110.30242, 24.05357, 0], [-110.30248, 24.0538, 0], [-110.30249, 24.05387, 0], [-110.30359, 24.05877, 0], [-110.30389, 24.06027, 0], [-110.30392, 24.06039, 0], [-110.30402, 24.06089, 0], [-110.30464, 24.06359, 0], [-110.30482, 24.06449, 0], [-110.30525, 24.06642, 0], [-110.30618, 24.07289, 0], [-110.3064, 24.07463, 0], [-110.30645, 24.0749, 0], [-110.30647, 24.07509, 0], [-110.3076, 24.08332, 0], [-110.30761, 24.08337, 0], [-110.30792, 24.08555, 0], [-110.30809, 24.08687, 0], [-110.30819, 24.08746, 0], [-110.3082, 24.08756, 0], [-110.30852, 24.08881, 0], [-110.30912, 24.09075, 0], [-110.30958, 24.09234, 0], [-110.30971, 24.09273, 0], [-110.30978, 24.09298, 0], [-110.30996, 24.09354, 0], [-110.31005, 24.09387, 0], [-110.31026, 24.09457, 0], [-110.3103, 24.09468, 0], [-110.31036, 24.09491, 0], [-110.31103, 24.09713, 0], [-110.31113, 24.09741, 0], [-110.31142, 24.09843, 0], [-110.31143, 24.09844, 0], [-110.31148, 24.09862, 0], [-110.31161, 24.09902, 0], [-110.31164, 24.09909, 0], [-110.3121, 24.10076, 0], [-110.3121, 24.10077, 0], [-110.31212, 24.10089, 0], [-110.31216, 24.10105, 0], [-110.31217, 24.10123, 0], [-110.31216, 24.10141, 0], [-110.312, 24.10229, 0], [-110.31192, 24.10266, 0], [-110.31191, 24.10273, 0], [-110.31188, 24.10286, 0], [-110.31186, 24.103, 0], [-110.31162, 24.10424, 0], [-110.3115, 24.10476, 0], [-110.31143, 24.10497, 0], [-110.31114, 24.10637, 0], [-110.31112, 24.10655, 0], [-110.31103, 24.10709, 0], [-110.31103, 24.10728, 0], [-110.31102, 24.10736, 0], [-110.31099, 24.1078, 0], [-110.31103, 24.1083, 0], [-110.31105, 24.10843, 0], [-110.31106, 24.10856, 0], [-110.31107, 24.1086, 0], [-110.31111, 24.11048, 0], [-110.31112, 24.11059, 0], [-110.31113, 24.11104, 0], [-110.31114, 24.11122, 0], [-110.3108, 24.11187, 0], [-110.31081, 24.11194, 0], [-110.31083, 24.11203, 0], [-110.31084, 24.11206, 0], [-110.31086, 24.11209, 0], [-110.31092, 24.11215, 0], [-110.31104, 24.11224, 0], [-110.31105, 24.11224, 0], [-110.31132, 24.1122, 0], [-110.31132, 24.11198, 0], [-110.3113, 24.11175, 0], [-110.3113, 24.1116, 0], [-110.31145, 24.1114, 0], [-110.31149, 24.11138, 0], [-110.31175, 24.11111, 0], [-110.31208, 24.11079, 0], [-110.31237, 24.11057, 0], [-110.31259, 24.11044, 0], [-110.31366, 24.10987, 0], [-110.31401, 24.10973, 0], [-110.31427, 24.10964, 0], [-110.31491, 24.10949, 0], [-110.31516, 24.10947, 0], [-110.31538, 24.10944, 0], [-110.31749, 24.10934, 0], [-110.31798, 24.10934, 0], [-110.31804, 24.10933, 0], [-110.31838, 24.10933, 0], [-110.31863, 24.10932, 0], [-110.3188, 24.10932, 0], [-110.31884, 24.10931, 0], [-110.319, 24.10931, 0], [-110.31943, 24.10929, 0], [-110.32014, 24.10929, 0], [-110.32042, 24.10933, 0], [-110.32076, 24.10941, 0], [-110.32104, 24.10949, 0], [-110.32124, 24.10956, 0], [-110.32168, 24.10975, 0], [-110.322, 24.10991, 0], [-110.32209, 24.10996, 0], [-110.32226, 24.11008, 0], [-110.32265, 24.1104, 0], [-110.32268, 24.11044, 0], [-110.3231, 24.11085, 0], [-110.3304, 24.1187, 0], [-110.33119, 24.11952, 0], [-110.33174, 24.12012, 0], [-110.33232, 24.12071, 0], [-110.33252, 24.12088, 0], [-110.33289, 24.12115, 0], [-110.33315, 24.12129, 0], [-110.33316, 24.12129, 0], [-110.33331, 24.12136, 0], [-110.33352, 24.12144, 0], [-110.33355, 24.12146, 0], [-110.33404, 24.12163, 0], [-110.33425, 24.12171, 0], [-110.33489, 24.12193, 0], [-110.33575, 24.12225, 0], [-110.33596, 24.12225, 0], [-110.33761, 24.12082, 0], [-110.33895, 24.1196, 0], [-110.33943, 24.1192, 0], [-110.34115, 24.11768, 0], [-110.34155, 24.11734, 0], [-110.34189, 24.11701, 0], [-110.3422, 24.11676, 0], [-110.34235, 24.11663, 0], [-110.34267, 24.11646, 0], [-110.34268, 24.11646, 0], [-110.34279, 24.11641, 0], [-110.343, 24.11635, 0], [-110.34319, 24.11631, 0], [-110.34393, 24.11628, 0], [-110.34404, 24.11627, 0], [-110.34464, 24.11624, 0], [-110.34478, 24.11622, 0], [-110.34498, 24.1162, 0], [-110.34516, 24.11617, 0], [-110.34558, 24.11607, 0], [-110.34581, 24.11599, 0], [-110.34599, 24.11592, 0], [-110.34626, 24.11579, 0], [-110.34648, 24.11566, 0], [-110.34662, 24.11556, 0], [-110.34696, 24.11529, 0], [-110.34697, 24.11528, 0], [-110.34698, 24.11528, 0], [-110.34712, 24.11515, 0], [-110.34815, 24.11427, 0], [-110.34831, 24.11415, 0], [-110.3488, 24.11386, 0], [-110.34891, 24.11376, 0], [-110.34911, 24.11368, 0], [-110.35729, 24.10981, 0], [-110.35732, 24.1098, 0], [-110.36148, 24.10784, 0], [-110.36501, 24.10631, 0], [-110.36567, 24.10605, 0], [-110.36571, 24.10604, 0], [-110.36623, 24.10582, 0], [-110.36625, 24.10582, 0], [-110.36638, 24.10576, 0], [-110.36656, 24.10569, 0], [-110.36657, 24.10569, 0], [-110.36676, 24.1056, 0], [-110.3703, 24.10415, 0], [-110.3704, 24.1041, 0], [-110.37106, 24.10385, 0], [-110.37121, 24.1038, 0], [-110.37135, 24.10373, 0], [-110.37384, 24.10271, 0], [-110.37392, 24.10267, 0], [-110.37816, 24.10093, 0], [-110.3782, 24.10091, 0], [-110.37835, 24.10085, 0], [-110.37856, 24.10075, 0], [-110.38166, 24.09946, 0], [-110.38189, 24.09938, 0], [-110.38218, 24.09929, 0], [-110.3827, 24.09917, 0], [-110.38398, 24.09897, 0], [-110.38749, 24.0985, 0], [-110.38877, 24.09831, 0], [-110.39264, 24.0978, 0], [-110.39277, 24.09779, 0], [-110.39311, 24.09775, 0]] }, "properties": { "name": "Indicaciones de Terminal 2 Internacional, 23429 San Jos√© del Cabo, B.C.S., M√©xico a M√©xico 1, 23205 El Zacatal, B.C.S., M√©xico", "styleUrl": "#line-1267FF-5000-nodesc", "stroke-opacity": 1, "stroke": "#1267ff", "stroke-width": 5 } }, { "type": "Feature", "geometry": { "type": "Point", "coordinates": [-109.7163099, 23.158052, 0] }, "properties": { "name": "Terminal 2 Internacional, 23429 San Jos√© del Cabo, B.C.S., M√©xico", "styleUrl": "#icon-1899-DB4436-nodesc", "icon-opacity": 1, "icon-color": "#db4436", "icon-scale": 1, "icon-offset": [32, 64], "icon-offset-units": ["pixels", "insetPixels"], "icon": "https://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png" } }, { "type": "Feature", "geometry": { "type": "Point", "coordinates": [-110.3931123, 24.0977464, 0] }, "properties": { "name": "M√©xico 1, 23205 El Zacatal, B.C.S., M√©xico", "styleUrl": "#icon-1899-DB4436-nodesc", "icon-opacity": 1, "icon-color": "#db4436", "icon-scale": 1, "icon-offset": [32, 64], "icon-offset-units": ["pixels", "insetPixels"], "icon": "https://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png" } }]
        };


        // =========================================================================
        // UNIR EL √öLTIMO TRAMO (Destino Final Airbnb) A LA RUTA DE SAN JOS√â
        // =========================================================================
        if (ROUTE_SJC && ROUTE_SJC.features) {

            // 1. Agregamos el punto de la Desviaci√≥n / Cruce
            ROUTE_SJC.features.push({
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [-110.3930924146773, 24.09772014879889, 4.183889859599872]
                },
                "properties": { "name": "Desviacion / Cruce" }
            });

            // 2. Agregamos la l√≠nea de la "Ruta 2 Airbnb"
            ROUTE_SJC.features.push({
                "type": "Feature",
                "geometry": {
                    "type": "LineString",
                    "coordinates": [
                        [-110.3930436743562, 24.09754761703125, 0],
                        [-110.3928194657311, 24.0962260369505, 0],
                        [-110.3926876313522, 24.09618915901778, 0],
                        [-110.3923589171539, 24.09620761028096, 0],
                        [-110.3922991407109, 24.09615135129986, 0],
                        [-110.392173137542, 24.09518587995925, 0],
                        [-110.3910261027907, 24.09532131661534, 0],
                        [-110.3910372199984, 24.09539877384319, 0]
                    ]
                },
                "properties": { "name": "Ruta 2 Airbnb" }
            });

            // 3. Agregamos el Punto de Destino Final
            ROUTE_SJC.features.push({
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [-110.391038445351, 24.09540285146841, 4.487690660529326]
                },
                "properties": { "name": "Destino - Airbnb BajaStays Rentals" }
            });
        };

        let app = {
            mode: 'default', selectedRouteType: 'lapaz', lang: 'es', voice: true,
            markers: [], points: [], route: null, step: 0, navigating: false,
            watchId: null, wakeLock: null, currentVisualHeading: 0, targetHeading: 0,
            compassOffset: 0, currentStyle: 'dark', navStartTime: 0, onboarded: false
        };

        let currentRouteData = ROUTE_LA_PAZ;

        const TXT = {
            es: {
                btn: "COMENZAR EXPERIENCIA", go: "INICIAR RUTA", manualTip: "Toca el mapa para a√±adir puntos", locating: "Calculando ruta desde tu ubicaci√≥n...", dest: "BajaStay Airbnb", welcome_lapaz: "Bienvenido a La Paz, ", welcome_sjc: "Bienvenido a Los Cabos, ", welcome_manual: "Bienvenido, ", bye: "Muchas gracias por hospedarse con nosotros, que tengan una estancia excelente.",
                inst: { s: "Sigue recto", l: "Gira izquierda", r: "Gira derecha", a: "Has llegado a tu destino" },
                on: "en", lbl: "Tu Nombre", placeholder_name: "¬øC√≥mo te llamas?", dest_label: 'Destino Seleccionado', ar_inst: 'Indicaciones AR', search: 'Buscar direcci√≥n o lugar...', calculating: "Calculando...", closing: "Cerrando...",
                select_route: "SELECCIONA TU RUTA", route_lapaz: "Ruta La Paz", route_lapaz_desc: "Aeropuerto LAP ‚ûú BajaStay", route_sjc: "Ruta San Jos√©", route_sjc_desc: "Aeropuerto SJC ‚ûú BajaStay", route_manual: "Ruta Manual", route_manual_desc: "Busca destino o toca el mapa", destination: "DESTINO", distance: "DISTANCIA", time: "TIEMPO", ob_title: "Modo Manual", ob_desc: "Busca un lugar en la barra superior o toca puntos en el mapa para trazar tu propia ruta personalizada desde donde est√©s.", ob_btn: "ENTENDIDO", sum_title: "¬°Has llegado!", sum_desc: "Esperamos que disfrutes tu estancia en BajaStay.", sum_btn: "VOLVER AL INICIO"
            },
            en: {
                btn: "START EXPERIENCE", go: "START ROUTE", manualTip: "Tap the map to add points", locating: "Calculating route from your location...", dest: "BajaStay Airbnb", welcome_lapaz: "Welcome to La Paz, ", welcome_sjc: "Welcome to Los Cabos, ", welcome_manual: "Welcome, ", bye: "Thank you for staying with us, we hope you have an excellent stay.",
                inst: { s: "Go straight", l: "Turn left", r: "Turn right", a: "You have arrived at your destination" },
                on: "on", lbl: "Your Name", placeholder_name: "What's your name?", dest_label: 'Selected Destination', ar_inst: 'AR Directions', search: 'Search address or place...', calculating: "Calculating...", closing: "Closing...",
                select_route: "SELECT YOUR ROUTE", route_lapaz: "La Paz Route", route_lapaz_desc: "LAP Airport ‚ûú BajaStay", route_sjc: "San Jose Route", route_sjc_desc: "SJC Airport ‚ûú BajaStay", route_manual: "Manual Route", route_manual_desc: "Search destination or tap map", destination: "DESTINATION", distance: "DISTANCE", time: "TIME", ob_title: "Manual Mode", ob_desc: "Search a place in the top bar or tap points on the map to draw your custom route from where you are.", ob_btn: "GOT IT", sum_title: "You've arrived!", sum_desc: "We hope you enjoy your stay at BajaStay.", sum_btn: "BACK TO HOME"
            }
        };

        const map = new mapboxgl.Map({ container: 'map', style: 'mapbox://styles/mapbox/streets-v12', center: [-110.367588, 24.076210], zoom: 12, pitch: 45, bearing: 0 });

        map.on('load', () => {
            document.getElementById('loader').style.opacity = '0';
            setTimeout(() => document.getElementById('loader').remove(), 500);
            document.getElementById('btn-layer').style.display = 'flex';
        });

        window.addEventListener('camera-error', () => {
            // Sin c√°mara AR: ignorar error de c√°mara
        });

        function selectRouteType(type) {
            app.selectedRouteType = type;
            document.getElementById('opt-lapaz').classList.remove('selected');
            document.getElementById('opt-sjc').classList.remove('selected');
            document.getElementById('opt-manual').classList.remove('selected');
            document.getElementById('opt-' + type).classList.add('selected');

            if (type === 'manual') {
                app.mode = 'manual';
            } else {
                app.mode = 'default';
                if (type === 'sjc') {
                    if (!ROUTE_SJC.features) {
                        alert("Por favor, sigue las instrucciones para pegar el contenido de tu archivo map.geojson de San Jos√©.");
                        document.getElementById('opt-sjc').classList.remove('selected');
                        document.getElementById('opt-lapaz').classList.add('selected');
                        currentRouteData = ROUTE_LA_PAZ;
                        return;
                    }
                    currentRouteData = ROUTE_SJC;
                } else {
                    currentRouteData = ROUTE_LA_PAZ;
                }
            }
            document.getElementById('search-container').style.display = (app.mode === 'manual') ? 'flex' : 'none';
        }

        // --- B√öSQUEDA INTELIGENTE MEJORADA CON TIPOS DE LUGARES ---
        async function handleSearchInput(query) {
            const suggestionsBox = document.getElementById('search-suggestions');
            if (!query || query.length < 3) { suggestionsBox.style.display = 'none'; return; }

            // Agregamos types=address,poi,place para buscar calles, negocios y colonias
            const center = map.getCenter();
            const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${mapboxgl.accessToken}&autocomplete=true&limit=6&types=address,poi,place,locality,neighborhood&proximity=${center.lng},${center.lat}&language=${app.lang}`;

            try {
                const res = await fetch(url);
                const data = await res.json();
                suggestionsBox.innerHTML = '';
                if (data.features.length > 0) {
                    data.features.forEach(feature => {
                        const div = document.createElement('div');
                        div.className = 'suggestion-item';
                        div.innerText = feature.place_name;
                        div.onclick = () => selectSuggestion(feature.geometry.coordinates[0], feature.geometry.coordinates[1], feature.place_name);
                        suggestionsBox.appendChild(div);
                    });
                    suggestionsBox.style.display = 'block';
                } else {
                    suggestionsBox.style.display = 'none';
                }
            } catch (e) { console.error(e); }
        }

        function selectSuggestion(lng, lat, placeName) {
            document.getElementById('search-input').value = placeName;
            document.getElementById('search-suggestions').style.display = 'none';
            document.getElementById('txt-dest-name').innerText = placeName.split(',')[0]; // Muestra el nombre corto
            document.getElementById('manual-tip').innerText = TXT[app.lang].locating;

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        const userLoc = [pos.coords.longitude, pos.coords.latitude];
                        const destLoc = [lng, lat];
                        app.points = [userLoc, destLoc];
                        app.markers.forEach(m => m.remove());
                        app.markers = [];

                        addUserMarker(userLoc);
                        addStaticMarker(destLoc, true);

                        const bounds = new mapboxgl.LngLatBounds();
                        bounds.extend(userLoc);
                        bounds.extend(destLoc);
                        map.fitBounds(bounds, { padding: 50, animate: true });
                        plotRoute(app.points);
                        document.getElementById('manual-tip').style.display = 'none';
                    },
                    (err) => {
                        alert("Para trazar desde tu ubicaci√≥n, permite el acceso al GPS en tu navegador.");
                        map.flyTo({ center: [lng, lat], zoom: 16 });
                    },
                    { enableHighAccuracy: true }
                );
            } else {
                alert("Geolocalizaci√≥n no soportada en este navegador.");
            }
        }

        function toggleStyle() {
            app.currentStyle = app.currentStyle === 'dark' ? 'satellite' : 'dark';
            const styleUrl = app.currentStyle === 'dark' ? 'mapbox://styles/mapbox/dark-v11' : 'mapbox://styles/mapbox/satellite-v9';
            map.setStyle(styleUrl);
            document.getElementById('btn-layer').innerText = app.currentStyle === 'dark' ? 'üõ∞Ô∏è' : 'üèôÔ∏è';

            map.once('style.load', () => {
                if (app.route && app.route.geometry) { renderRouteOnMap(app.route.geometry); }
            });
        }

        function confirmSelection() {
            if (app.mode === 'manual' && !app.onboarded) {
                document.getElementById('onboarding-tip').style.display = 'flex';
                app.onboarded = true;
            } else {
                document.getElementById('landing-overlay').classList.add('closed');
                initMapLogic();
                setTimeout(() => { if (map) map.resize(); }, 300);
            }
        }

        function showLanding() { document.getElementById('landing-overlay').classList.remove('closed'); }

        function fullCleanup() {
            app.navigating = false;
            app.points = [];
            app.markers.forEach(m => m.remove());
            app.markers = [];
            app.route = null;
            app.step = 0;
            document.getElementById('summary-screen').style.display = 'none';
            if (app.navMap) { app.navMap.remove(); app.navMap = null; }
            app.navUserMarker = null;
            if (map.getSource('route')) { map.getSource('route').setData({ type: 'FeatureCollection', features: [] }); }
            window.speechSynthesis.cancel();
            if (app.watchId !== null) { navigator.geolocation.clearWatch(app.watchId); app.watchId = null; }
            window.removeEventListener('deviceorientation', handleOrientation);
            if (app.wakeLock) { app.wakeLock.release().catch(() => { }); app.wakeLock = null; }
        }

        function forceStopAndShowLanding() {
            fullCleanup();
            const mmc = document.getElementById('mini-map-container');
            if (mmc) { mmc.style.top = ''; mmc.style.left = '5%'; mmc.style.bottom = '30px'; mmc.style.right = ''; }
            document.getElementById('ar-view').classList.remove('visible');
            document.getElementById('map-view').classList.remove('hidden');
            document.getElementById('map-view').style.opacity = 1;
            showLanding();
            setTimeout(() => { if (map) map.resize(); }, 150);
        }

        function handleLangToggle(e) {
            if (e) { e.preventDefault(); e.stopPropagation(); }
            app.lang = app.lang === 'es' ? 'en' : 'es';
            updateLangUI();
        }

        function updateLangUI() {
            const t = TXT[app.lang];

            document.getElementById('btn-lang').innerText = app.lang.toUpperCase();
            document.getElementById('btn-lang-landing').innerText = app.lang.toUpperCase();
            document.getElementById('btn-lang-ar').innerText = app.lang.toUpperCase();

            document.getElementById('lbl-name').innerText = t.lbl;
            document.getElementById('user-name').placeholder = t.placeholder_name;
            document.getElementById('lbl-select-route').innerText = t.select_route;

            document.getElementById('lbl-route-lapaz').innerText = t.route_lapaz;
            document.getElementById('lbl-desc-lapaz').innerText = t.route_lapaz_desc;

            document.getElementById('lbl-route-sjc').innerText = t.route_sjc;
            document.getElementById('lbl-desc-sjc').innerText = t.route_sjc_desc;

            document.getElementById('lbl-route-manual').innerText = t.route_manual;
            document.getElementById('lbl-desc-manual').innerText = t.route_manual_desc;
            document.getElementById('btn-confirm').innerText = t.btn;

            document.getElementById('search-input').placeholder = t.search;
            document.getElementById('lbl-dest-title').innerText = t.destination;
            document.getElementById('lbl-dist-title').innerText = t.distance;
            document.getElementById('lbl-time-title').innerText = t.time;
            document.getElementById('btn-go').innerText = t.go;

            document.getElementById('lbl-ob-title').innerText = t.ob_title;
            document.getElementById('lbl-ob-desc').innerText = t.ob_desc;
            document.getElementById('btn-ob').innerText = t.ob_btn;

            document.getElementById('lbl-sum-title').innerText = t.sum_title;
            document.getElementById('lbl-sum-desc').innerText = t.sum_desc;
            document.getElementById('btn-sum').innerText = t.sum_btn;

            if (app.mode === 'default') {
                const destName = document.getElementById('txt-dest-name');
                if (destName && destName.innerText !== "...") destName.innerText = t.dest;
            } else if (app.mode === 'manual') {
                const tip = document.getElementById('manual-tip');
                if (tip) tip.innerText = t.manualTip;
            }
        }

        function initMapLogic() {
            app.markers.forEach(m => m.remove());
            app.markers = [];
            document.getElementById('btn-go').disabled = true;

            if (app.mode === 'default') {
                document.getElementById('manual-tip').style.display = 'none';
                plotStaticRoute();
            } else {
                document.getElementById('manual-tip').style.display = 'block';
                if (navigator.geolocation && app.points.length === 0) {
                    document.getElementById('manual-tip').innerText = TXT[app.lang].locating;
                    navigator.geolocation.getCurrentPosition(pos => {
                        const c = [pos.coords.longitude, pos.coords.latitude];
                        app.points.push(c);
                        addUserMarker(c);
                        map.flyTo({ center: c, zoom: 15 });
                        document.getElementById('manual-tip').innerText = TXT[app.lang].manualTip;
                    }, err => alert("GPS Error: Activa ubicaci√≥n"), { enableHighAccuracy: true });
                }
            }
        }

        function addUserMarker(coords) {
            const el = document.createElement('div'); el.className = 'user-marker';
            const m = new mapboxgl.Marker(el).setLngLat(coords).addTo(map); app.markers.push(m);
        }

        function addStaticMarker(coords, isDest = false) {
            const el = document.createElement('div');
            el.style.width = '16px'; el.style.height = '16px';
            el.style.backgroundColor = isDest ? '#29b6f6' : '#43a047';
            el.style.borderRadius = '50%'; el.style.border = '3px solid #fff';
            const m = new mapboxgl.Marker(el).setLngLat(coords).addTo(map); app.markers.push(m);
        }

        map.on('click', e => {
            if (app.mode !== 'manual') return;
            const c = [e.lngLat.lng, e.lngLat.lat];
            app.points.push(c);
            const el = document.createElement('div'); el.className = 'ctrl-btn'; el.innerText = app.points.length;
            el.style.width = '26px'; el.style.height = '26px'; el.style.fontSize = '12px'; el.style.background = '#FDF8F5'; el.style.color = '#1c1917';
            app.markers.push(new mapboxgl.Marker(el).setLngLat(c).addTo(map));
            if (app.points.length >= 2) plotRoute(app.points);
        });

        async function plotStaticRoute() {
            let coordinates = []; let hasPoints = false;
            let originCoord = null; let destCoord = null;

            currentRouteData.features.forEach(f => {
                if (f.geometry && f.geometry.type === 'LineString') coordinates.push(...f.geometry.coordinates);
                if (f.geometry && f.geometry.type === 'Point') {
                    hasPoints = true;
                    const isDest = f.properties && f.properties.name && f.properties.name.toLowerCase().includes('destino');
                    addStaticMarker(f.geometry.coordinates, isDest);
                    if (isDest) destCoord = f.geometry.coordinates;
                    else if (!originCoord) originCoord = f.geometry.coordinates;
                }
            });

            if (!hasPoints && coordinates.length > 0) {
                originCoord = coordinates[0];
                destCoord = coordinates[coordinates.length - 1];
                addStaticMarker(originCoord, false);
                addStaticMarker(destCoord, true);
            }

            const totalDist = calcTotalDist(coordinates);

            // Guardar la geometr√≠a previa de la ruta personalizada
            app.route = {
                geometry: { type: 'LineString', coordinates: coordinates },
                distance: totalDist,
                duration: null  // pendiente de API
            };

            renderRouteOnMap(app.route.geometry);
            document.getElementById('txt-dest-name').innerText = TXT[app.lang].dest;
            document.getElementById('txt-time').innerText = TXT[app.lang].calculating || 'Calculando...';
            document.getElementById('txt-dist').innerText = (totalDist / 1000).toFixed(1) + ' km';

            // Consultar duraci√≥n real con Mapbox Directions API (driving-traffic)
            if (originCoord && destCoord) {
                try {
                    const o = originCoord[0] + ',' + originCoord[1];
                    const d = destCoord[0] + ',' + destCoord[1];
                    // A√±adimos un punto intermedio para mejorar la precisi√≥n en rutas largas
                    let waypointsStr = o + ';' + d;
                    if (coordinates.length > 100) {
                        const mid = coordinates[Math.floor(coordinates.length / 2)];
                        waypointsStr = o + ';' + mid[0] + ',' + mid[1] + ';' + d;
                    }
                    const url = `https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${waypointsStr}?geometries=geojson&access_token=${mapboxgl.accessToken}&language=${app.lang}`;
                    const res = await fetch(url);
                    const data = await res.json();
                    if (data.routes && data.routes[0]) {
                        const apiRoute = data.routes[0];
                        app.route.duration = apiRoute.duration;
                        app.route.apiDist = apiRoute.distance;
                        updateRouteInfo(apiRoute.distance, apiRoute.duration);
                    } else {
                        // Fallback: velocidad promedio 80 km/h = 22.22 m/s
                        app.route.duration = totalDist / 22.22;
                        updateRouteInfo(totalDist, app.route.duration);
                    }
                } catch (e) {
                    console.warn('Directions API error, usando velocidad promedio:', e);
                    // Fallback: 80 km/h para carreteras
                    app.route.duration = totalDist / 22.22;
                    updateRouteInfo(totalDist, app.route.duration);
                }
            } else {
                app.route.duration = totalDist / 22.22;
                updateRouteInfo(totalDist, app.route.duration);
            }
        }

        function dist(lat1, lon1, lat2, lon2) {
            const R = 6371e3; const p1 = lat1 * Math.PI / 180, p2 = lat2 * Math.PI / 180;
            const dp = (lat2 - lat1) * Math.PI / 180, dl = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dp / 2) * Math.sin(dp / 2) + Math.cos(p1) * Math.cos(p2) * Math.sin(dl / 2) * Math.sin(dl / 2);
            return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        }

        function calcTotalDist(coords) {
            let d = 0;
            for (let i = 0; i < coords.length - 1; i++) { d += dist(coords[i][1], coords[i][0], coords[i + 1][1], coords[i + 1][0]); }
            return d;
        }

        async function plotRoute(coords) {
            const currentMode = app.mode;
            document.getElementById('btn-go').disabled = true;
            document.getElementById('txt-time').innerText = TXT[app.lang].calculating || 'Calculando...';
            const str = coords.map(c => c.join(',')).join(';');
            try {
                const res = await fetch(`https://api.mapbox.com/directions/v5/mapbox/driving-traffic/${str}?steps=true&geometries=geojson&access_token=${mapboxgl.accessToken}&language=${app.lang}`);
                const data = await res.json();
                if (app.mode !== currentMode) return;
                if (!data.routes || !data.routes[0]) {
                    console.warn('No routes returned'); return;
                }
                const route = data.routes[0]; app.route = route;
                renderRouteOnMap(route.geometry); updateRouteInfo(route.distance, route.duration);
            } catch (e) { console.error(e); }
        }

        function formatTime(seconds) {
            const minutes = Math.round(seconds / 60);
            if (minutes < 60) return minutes + " min";
            const hours = Math.floor(minutes / 60); const remainingMinutes = minutes % 60;
            return `${hours} h ${remainingMinutes} min`;
        }

        function updateRouteInfo(distanceMeters, durationSeconds) {
            document.getElementById('txt-time').innerText = formatTime(durationSeconds);
            document.getElementById('txt-dist').innerText = (distanceMeters / 1000).toFixed(1) + " km";
            document.getElementById('btn-go').disabled = false;
        }

        function renderRouteOnMap(geometry) {
            if (map.getSource('route')) {
                map.getSource('route').setData(geometry);
            } else {
                map.addSource('route', { 'type': 'geojson', 'data': geometry });
                map.addLayer({
                    'id': 'route', 'type': 'line', 'source': 'route',
                    'layout': { 'line-join': 'round', 'line-cap': 'round' },
                    'paint': { 'line-color': '#29b6f6', 'line-width': 7 }
                });
            }
            const bounds = new mapboxgl.LngLatBounds();
            geometry.coordinates.forEach(c => bounds.extend(c));
            map.fitBounds(bounds, { padding: 40 });
        }

        // --- ARRANQUE DE AR CON REPARACI√ìN DE AUDIO ---
        window.attemptStartAR = async () => {
            // ¬°NUEVO!: Forzamos al navegador a hablar INMEDIATAMENTE al hacer clic para "despertar" el motor de audio de iOS/Android
            const name = document.getElementById('user-name').value || "";
            let welcomeTxt = "";
            if (app.selectedRouteType === 'lapaz') welcomeTxt = TXT[app.lang].welcome_lapaz + name;
            else if (app.selectedRouteType === 'sjc') welcomeTxt = TXT[app.lang].welcome_sjc + name;
            else welcomeTxt = TXT[app.lang].welcome_manual + name;

            speak(welcomeTxt, true); // True fuerza la reproducci√≥n incluso antes de que empiece a navegar oficialmente

            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                try {
                    const permission = await DeviceOrientationEvent.requestPermission();
                    if (permission === 'granted') { startAR(); }
                    else { alert(app.lang === 'en' ? "Compass orientation permission denied." : "Se requiere permiso de orientaci√≥n para la br√∫jula."); }
                } catch (e) { alert(e); }
            } else {
                startAR();
            }
        };

        async function startAR() {
            if (app.watchId) navigator.geolocation.clearWatch(app.watchId);
            app.navigating = true;
            try { if ('wakeLock' in navigator) { app.wakeLock = await navigator.wakeLock.request('screen'); } } catch (err) { }

            document.getElementById('map-view').style.opacity = 0;
            document.getElementById('map-view').classList.add('hidden');
            document.getElementById('ar-view').classList.add('visible');
            document.getElementById('ar-instr').innerText = TXT[app.lang].inst.s;

            app.navStartTime = Date.now();

            // Inicializar mapa de navegaci√≥n (estilo Google Maps)
            if (app.navMap) { app.navMap.remove(); app.navMap = null; }
            app.navMap = new mapboxgl.Map({
                container: 'nav-map',
                style: 'mapbox://styles/mapbox/streets-v12',
                center: app.route && app.route.geometry ? app.route.geometry.coordinates[0] : [-110.367588, 24.076210],
                zoom: 17,
                pitch: 60,
                bearing: 0,
                attributionControl: false
            });

            app.navMap.on('load', () => {
                // Ruta en el mapa de navegaci√≥n
                if (app.route && app.route.geometry) {
                    app.navMap.addLayer({
                        id: 'nav-route', type: 'line',
                        source: { type: 'geojson', data: app.route.geometry },
                        layout: { 'line-join': 'round', 'line-cap': 'round' },
                        paint: { 'line-color': '#29b6f6', 'line-width': 8 }
                    });
                }
                // Marcador de posici√≥n del usuario
                const userEl = document.createElement('div');
                userEl.className = 'user-marker';
                app.navUserMarker = new mapboxgl.Marker(userEl)
                    .setLngLat(app.route && app.route.geometry ? app.route.geometry.coordinates[0] : [-110.367588, 24.076210])
                    .addTo(app.navMap);
            });

            window.addEventListener('deviceorientation', handleOrientation);

            app.watchId = navigator.geolocation.watchPosition(handleGPS, (err) => {
                alert("GPS Error: Activa tu ubicaci√≥n para navegar.");
            }, { enableHighAccuracy: true, maximumAge: 0 });

            requestAnimationFrame(renderLoop);
        }

        function handleOrientation(e) {
            if (e.webkitCompassHeading) app.compassOffset = e.webkitCompassHeading;
            else if (e.alpha) app.compassOffset = 360 - e.alpha;
        }

        function stopAR() { forceStopAndShowLanding(); }

        let userInteractingWithMiniMap = false;
        function initMiniMap() {
            if (app.miniMap) app.miniMap.remove();
            let startCoord = [-110.367588, 24.076210];
            if (app.route && app.route.geometry && app.route.geometry.coordinates.length > 0) {
                startCoord = app.route.geometry.coordinates[app.step] || app.route.geometry.coordinates[0];
            }
            app.miniMap = new mapboxgl.Map({
                container: 'mini-map', style: 'mapbox://styles/mapbox/dark-v11', center: startCoord, zoom: 14, pitch: 0, interactive: true, attributionControl: false
            });
            app.miniMap.on('dragstart', () => userInteractingWithMiniMap = true);
            app.miniMap.on('dragend', () => setTimeout(() => userInteractingWithMiniMap = false, 3000));
            app.miniMap.on('zoomstart', () => userInteractingWithMiniMap = true);
            app.miniMap.on('zoomend', () => setTimeout(() => userInteractingWithMiniMap = false, 3000));

            app.miniMap.on('load', () => {
                if (app.route) {
                    app.miniMap.addLayer({
                        id: 'mini-route', type: 'line', source: { type: 'geojson', data: app.route.geometry },
                        layout: { 'line-join': 'round', 'line-cap': 'round' },
                        paint: { 'line-color': '#1267ff', 'line-width': 6 }
                    });

                    if (app.mode === 'default') {
                        currentRouteData.features.forEach(f => {
                            if (f.geometry && f.geometry.type === 'Point') {
                                const elPoint = document.createElement('div');
                                elPoint.style.width = '10px'; elPoint.style.height = '10px';
                                elPoint.style.backgroundColor = (f.properties && f.properties.name && f.properties.name.includes('Destino')) ? '#F2A65A' : '#ffffff';
                                elPoint.style.borderRadius = '50%'; elPoint.style.border = '2px solid #1c1917';
                                new mapboxgl.Marker(elPoint).setLngLat(f.geometry.coordinates).addTo(app.miniMap);
                            }
                        });
                        const mb = new mapboxgl.LngLatBounds();
                        app.route.geometry.coordinates.forEach(p => mb.extend(p));
                        app.miniMap.fitBounds(mb, { padding: 40, animate: false });
                    }

                    const el = document.createElement('div');
                    el.style.width = '18px'; el.style.height = '18px'; el.style.backgroundColor = '#F2A65A'; el.style.borderRadius = '50%'; el.style.border = '3px solid #FFF';
                    app.miniMarker = new mapboxgl.Marker(el).setLngLat(startCoord).addTo(app.miniMap);
                }
            });
        }

        async function getStreetName(lng, lat) {
            try {
                const res = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${lng},${lat}.json?access_token=${mapboxgl.accessToken}&types=address,poi`);
                const data = await res.json();
                if (data.features.length > 0) return data.features[0].text;
            } catch (e) { }
            return "";
        }

        async function handleGPS(pos) {
            if (!app.navigating || !app.route) return;
            const lat = pos.coords.latitude;
            const lng = pos.coords.longitude;
            const steps = app.route.geometry.coordinates;

            let endPoint = app.mode === 'manual' ? app.points[app.points.length - 1] : steps[steps.length - 1];
            const dFinal = dist(lat, lng, endPoint[1], endPoint[0]);

            if (dFinal < 40) {
                app.navigating = false;
                const name = document.getElementById('user-name').value || "";
                speak(TXT[app.lang].bye + " " + name);
                setTimeout(() => {
                    document.getElementById('sum-dist').innerText = document.getElementById('txt-dist').innerText;
                    document.getElementById('sum-time').innerText = document.getElementById('txt-time').innerText;
                    document.getElementById('summary-screen').style.display = 'flex';
                }, 4000);
                return;
            }

            let prevStep = app.step;
            let target = steps[app.step];

            const distToTarget = dist(lat, lng, target[1], target[0]);
            if (distToTarget < 60 && app.step < steps.length - 1) {
                app.step++; target = steps[app.step];
            }

            if (app.step > prevStep && app.step < steps.length - 1) {
                const p2 = steps[app.step];
                if (!app.isFetchingStreet) {
                    app.isFetchingStreet = true;
                    getStreetName(p2[0], p2[1]).then(newStreet => {
                        app.isFetchingStreet = false;
                        const baseInst = TXT[app.lang].inst.s;
                        const fullText = newStreet ? `${baseInst} ${TXT[app.lang].on} ${newStreet}` : baseInst;
                        document.getElementById('ar-instr').innerText = fullText;
                        const timeSinceStart = Date.now() - app.navStartTime;
                        if (app.voice && timeSinceStart > 4000) speak(fullText);
                    });
                }
            }

            if (app.navMap && app.navUserMarker) {
                app.navUserMarker.setLngLat([lng, lat]);
                app.navMap.setCenter([lng, lat]);
                app.navMap.setBearing(app.currentVisualHeading);
            }

            // Tiempo restante: usar proporci√≥n del tiempo total de la ruta
            // seg√∫n distancia recorrida vs total (m√°s preciso que velocidad fija)
            let dRem = 0;
            dRem += dist(lat, lng, target[1], target[0]);
            for (let i = app.step; i < steps.length - 1; i++) {
                dRem += dist(steps[i][1], steps[i][0], steps[i + 1][1], steps[i + 1][0]);
            }
            // Velocidad promedio basada en la ruta:
            // Si tenemos duraci√≥n real de la API, usamos la proporci√≥n distancia/tiempo
            // Si no, usamos 85 km/h (carretera = 23.61 m/s) como promedio realista
            let avgSpeedMs;
            if (app.route.duration && app.route.distance && app.route.distance > 0) {
                avgSpeedMs = app.route.distance / app.route.duration;
            } else {
                avgSpeedMs = 23.61; // 85 km/h en m/s
            }
            const timeRemSec = dRem / avgSpeedMs;
            const distTxt = (dRem / 1000).toFixed(1) + " km";
            const timeTxt = formatTime(timeRemSec);

            document.getElementById('ar-next-dist').innerText = distTxt;
            document.getElementById('ar-next-time').innerText = timeTxt;
            document.getElementById('ar-next-dist-big').innerText = distTxt + " restantes";
            document.getElementById('ar-next-time-big').innerText = timeTxt;

            app.targetHeading = Math.atan2(target[0] - lng, target[1] - lat) * 180 / Math.PI;
            let relativeAngle = app.targetHeading - app.compassOffset;
            while (relativeAngle > 180) relativeAngle -= 360;
            while (relativeAngle < -180) relativeAngle += 360;

            let k = "s";
            if (relativeAngle < -45) k = "l";
            if (relativeAngle > 45) k = "r";
            const isLastStep = app.step >= steps.length - 1;

            if (dFinal < 40 && isLastStep) {
                k = "a";
                if (app.navigating) {
                    app.navigating = false;
                    speak(TXT[app.lang].inst[k] + ". " + TXT[app.lang].bye);
                    setTimeout(() => stopAR(), 8000);
                }
            }

            const txt = TXT[app.lang].inst[k];
            if (!document.getElementById('ar-instr').innerText.startsWith(txt)) {
                document.getElementById('ar-instr').innerText = txt;
                const timeSinceStart = Date.now() - app.navStartTime;
                if (app.voice && timeSinceStart > 4000) speak(txt);
            }
        }

        function renderLoop() {
            if (!app.navigating) return;
            let desiredRel = app.targetHeading - app.compassOffset;
            let diff = desiredRel - app.currentVisualHeading;
            while (diff < -180) diff += 360;
            while (diff > 180) diff -= 360;
            app.currentVisualHeading += diff * 0.1;
            requestAnimationFrame(renderLoop);
        }

        // --- SISTEMA DE AUDIO MODIFICADO ---
        function speak(text, force = false) {
            if (!app.voice) return;
            // Solo habla si est√° navegando, A MENOS que enviemos force=true (como en el bot√≥n de Inicio)
            if (!app.navigating && !force) return;

            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text);
            u.lang = app.lang === 'es' ? 'es-MX' : 'en-US';
            u.rate = 1.0;
            window.speechSynthesis.speak(u);
        }

        function handleVoiceToggle() {
            app.voice = !app.voice;
            document.getElementById('btn-voice').innerText = app.voice ? 'üîä' : 'üîá';
            document.getElementById('btn-voice').style.opacity = app.voice ? '1' : '0.5';
            if (!app.voice) window.speechSynthesis.cancel();
        }

        const mmc = document.getElementById('mini-map-container');
        const handle = document.getElementById('mini-map-drag-handle');
        let isMMDragging = false;
        let mmStartX, mmStartY, mmStartLeft, mmStartTop;

        if (handle) {
            handle.addEventListener('touchstart', mmDragStart, { passive: false });
            document.addEventListener('touchmove', mmDrag, { passive: false });
            document.addEventListener('touchend', mmDragEnd);
            handle.addEventListener('mousedown', mmDragStart);
            document.addEventListener('mousemove', mmDrag);
            document.addEventListener('mouseup', mmDragEnd);
        }

        function mmDragStart(e) {
            if (e.target !== handle && !handle.contains(e.target)) return;
            isMMDragging = true;
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            mmStartX = clientX; mmStartY = clientY;
            const rect = mmc.getBoundingClientRect();
            mmc.style.bottom = 'auto'; mmc.style.right = 'auto';
            mmc.style.left = rect.left + 'px'; mmc.style.top = rect.top + 'px';
            mmStartLeft = rect.left; mmStartTop = rect.top;
        }

        function mmDrag(e) {
            if (!isMMDragging) return;
            if (e.cancelable) e.preventDefault();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            const dx = clientX - mmStartX; const dy = clientY - mmStartY;
            mmc.style.left = (mmStartLeft + dx) + 'px'; mmc.style.top = (mmStartTop + dy) + 'px';
        }

        function mmDragEnd() { isMMDragging = false; }
    </script>
</body>

</html>
